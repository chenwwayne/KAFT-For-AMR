Using device: cuda

========================================
Running with parameters:
             dataset: RML201604c
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201604c/RML201604c_MKAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 162060
Padding: (129560, 128, 2)
Padding: (32500, 128, 2)
Padding: (32500, 128, 2)

Final data shapes:
X_train: (129560, 128, 2), Y_train: (129560, 11)
X_val: (32500, 128, 2), Y_val: (32500, 11)
X_test: (32500, 128, 2), Y_test: (32500, 11)
After reshaping and sampling:
X_train: (129560, 256) (sampled from original)
X_val:   (32500, 256) (sampled from original)
X_test:  (32500, 256) (sampled from original)
Y_train: (129560, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.5620, Val Loss: 1.3418, Test Loss: 1.3418, Val Acc: 0.4926, Test Acc: 0.4926
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.2793, Val Loss: 1.2476, Test Loss: 1.2476, Val Acc: 0.5391, Test Acc: 0.5391
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.2319, Val Loss: 1.2352, Test Loss: 1.2352, Val Acc: 0.5453, Test Acc: 0.5453
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.2077, Val Loss: 1.2226, Test Loss: 1.2226, Val Acc: 0.5507, Test Acc: 0.5507
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.1874, Val Loss: 1.2159, Test Loss: 1.2159, Val Acc: 0.5515, Test Acc: 0.5515
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.1646, Val Loss: 1.1941, Test Loss: 1.1941, Val Acc: 0.5624, Test Acc: 0.5624
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.1506, Val Loss: 1.1916, Test Loss: 1.1916, Val Acc: 0.5639, Test Acc: 0.5639
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.1325, Val Loss: 1.1944, Test Loss: 1.1944, Val Acc: 0.5629, Test Acc: 0.5629

Epoch 8, Train Loss: 1.1187, Val Loss: 1.1668, Test Loss: 1.1668, Val Acc: 0.5737, Test Acc: 0.5737
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.1062, Val Loss: 1.1684, Test Loss: 1.1684, Val Acc: 0.5720, Test Acc: 0.5720

Epoch 10, Train Loss: 1.0921, Val Loss: 1.1690, Test Loss: 1.1690, Val Acc: 0.5740, Test Acc: 0.5740
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.0817, Val Loss: 1.1865, Test Loss: 1.1865, Val Acc: 0.5755, Test Acc: 0.5755
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 1.0705, Val Loss: 1.1829, Test Loss: 1.1829, Val Acc: 0.5710, Test Acc: 0.5710

Epoch 13, Train Loss: 1.0605, Val Loss: 1.1809, Test Loss: 1.1809, Val Acc: 0.5729, Test Acc: 0.5729

Epoch 14, Train Loss: 1.0514, Val Loss: 1.1889, Test Loss: 1.1889, Val Acc: 0.5716, Test Acc: 0.5716

Epoch 15, Train Loss: 1.0375, Val Loss: 1.1649, Test Loss: 1.1649, Val Acc: 0.5777, Test Acc: 0.5777
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.0275, Val Loss: 1.1913, Test Loss: 1.1913, Val Acc: 0.5743, Test Acc: 0.5743

Epoch 17, Train Loss: 1.0154, Val Loss: 1.1989, Test Loss: 1.1989, Val Acc: 0.5738, Test Acc: 0.5738

Epoch 18, Train Loss: 1.0052, Val Loss: 1.2203, Test Loss: 1.2203, Val Acc: 0.5733, Test Acc: 0.5733

Epoch 19, Train Loss: 0.9938, Val Loss: 1.2368, Test Loss: 1.2368, Val Acc: 0.5690, Test Acc: 0.5690

Epoch 20, Train Loss: 0.9795, Val Loss: 1.2511, Test Loss: 1.2511, Val Acc: 0.5726, Test Acc: 0.5726

Epoch 21, Train Loss: 0.9721, Val Loss: 1.2699, Test Loss: 1.2699, Val Acc: 0.5745, Test Acc: 0.5745

Epoch 22, Train Loss: 0.9012, Val Loss: 1.3079, Test Loss: 1.3079, Val Acc: 0.5710, Test Acc: 0.5710

Epoch 23, Train Loss: 0.8753, Val Loss: 1.3353, Test Loss: 1.3353, Val Acc: 0.5716, Test Acc: 0.5716

Epoch 24, Train Loss: 0.8553, Val Loss: 1.3388, Test Loss: 1.3388, Val Acc: 0.5742, Test Acc: 0.5742

Epoch 25, Train Loss: 0.8386, Val Loss: 1.3764, Test Loss: 1.3764, Val Acc: 0.5718, Test Acc: 0.5718

Epoch 26, Train Loss: 0.8195, Val Loss: 1.4371, Test Loss: 1.4371, Val Acc: 0.5724, Test Acc: 0.5724

Epoch 27, Train Loss: 0.8018, Val Loss: 1.4750, Test Loss: 1.4750, Val Acc: 0.5693, Test Acc: 0.5693

Epoch 28, Train Loss: 0.7410, Val Loss: 1.5554, Test Loss: 1.5554, Val Acc: 0.5704, Test Acc: 0.5704

Epoch 29, Train Loss: 0.7145, Val Loss: 1.6110, Test Loss: 1.6110, Val Acc: 0.5723, Test Acc: 0.5723

Epoch 30, Train Loss: 0.6934, Val Loss: 1.6324, Test Loss: 1.6324, Val Acc: 0.5718, Test Acc: 0.5718

Epoch 31, Train Loss: 0.6784, Val Loss: 1.6942, Test Loss: 1.6942, Val Acc: 0.5708, Test Acc: 0.5708

Epoch 32, Train Loss: 0.6635, Val Loss: 1.7394, Test Loss: 1.7394, Val Acc: 0.5701, Test Acc: 0.5701

Epoch 33, Train Loss: 0.6487, Val Loss: 1.7344, Test Loss: 1.7344, Val Acc: 0.5719, Test Acc: 0.5719

Epoch 34, Train Loss: 0.6091, Val Loss: 1.8806, Test Loss: 1.8806, Val Acc: 0.5694, Test Acc: 0.5694

Epoch 35, Train Loss: 0.5931, Val Loss: 1.9383, Test Loss: 1.9383, Val Acc: 0.5688, Test Acc: 0.5688

Epoch 36, Train Loss: 0.5827, Val Loss: 1.9199, Test Loss: 1.9199, Val Acc: 0.5688, Test Acc: 0.5688

Epoch 37, Train Loss: 0.5715, Val Loss: 1.9756, Test Loss: 1.9756, Val Acc: 0.5683, Test Acc: 0.5683

Epoch 38, Train Loss: 0.5603, Val Loss: 1.9768, Test Loss: 1.9768, Val Acc: 0.5687, Test Acc: 0.5687

Epoch 39, Train Loss: 0.5531, Val Loss: 2.0964, Test Loss: 2.0964, Val Acc: 0.5646, Test Acc: 0.5646

Epoch 40, Train Loss: 0.5296, Val Loss: 2.0967, Test Loss: 2.0967, Val Acc: 0.5658, Test Acc: 0.5658

Epoch 41, Train Loss: 0.5236, Val Loss: 2.1661, Test Loss: 2.1661, Val Acc: 0.5658, Test Acc: 0.5658

Epoch 42, Train Loss: 0.5166, Val Loss: 2.1463, Test Loss: 2.1463, Val Acc: 0.5651, Test Acc: 0.5651

Epoch 43, Train Loss: 0.5133, Val Loss: 2.1213, Test Loss: 2.1213, Val Acc: 0.5678, Test Acc: 0.5678

Epoch 44, Train Loss: 0.5085, Val Loss: 2.2115, Test Loss: 2.2115, Val Acc: 0.5657, Test Acc: 0.5657

Epoch 45, Train Loss: 0.5049, Val Loss: 2.1996, Test Loss: 2.1996, Val Acc: 0.5651, Test Acc: 0.5651

Epoch 46, Train Loss: 0.4916, Val Loss: 2.2477, Test Loss: 2.2477, Val Acc: 0.5651, Test Acc: 0.5651

Epoch 47, Train Loss: 0.4897, Val Loss: 2.2480, Test Loss: 2.2480, Val Acc: 0.5654, Test Acc: 0.5654

Epoch 48, Train Loss: 0.4858, Val Loss: 2.2328, Test Loss: 2.2328, Val Acc: 0.5667, Test Acc: 0.5667

Epoch 49, Train Loss: 0.4836, Val Loss: 2.2585, Test Loss: 2.2585, Val Acc: 0.5650, Test Acc: 0.5650

Epoch 50, Train Loss: 0.4803, Val Loss: 2.2595, Test Loss: 2.2595, Val Acc: 0.5665, Test Acc: 0.5665

Epoch 51, Train Loss: 0.4777, Val Loss: 2.2769, Test Loss: 2.2769, Val Acc: 0.5656, Test Acc: 0.5656

