Using device: cuda

========================================
Running with parameters:
             dataset: RML201604c
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201604c/RML201604c_MKAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 162060
Padding: (129560, 128, 2)
Padding: (32500, 128, 2)
Padding: (32500, 128, 2)

Final data shapes:
X_train: (129560, 128, 2), Y_train: (129560, 11)
X_val: (32500, 128, 2), Y_val: (32500, 11)
X_test: (32500, 128, 2), Y_test: (32500, 11)
After reshaping and sampling:
X_train: (129560, 256) (sampled from original)
X_val:   (32500, 256) (sampled from original)
X_test:  (32500, 256) (sampled from original)
Y_train: (129560, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.6804, Val Loss: 1.3300, Test Loss: 1.3300, Val Acc: 0.5042, Test Acc: 0.5042
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.3018, Val Loss: 1.2741, Test Loss: 1.2741, Val Acc: 0.5221, Test Acc: 0.5221
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.2539, Val Loss: 1.2291, Test Loss: 1.2291, Val Acc: 0.5474, Test Acc: 0.5474
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.2181, Val Loss: 1.2162, Test Loss: 1.2162, Val Acc: 0.5481, Test Acc: 0.5481
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.1948, Val Loss: 1.2050, Test Loss: 1.2050, Val Acc: 0.5558, Test Acc: 0.5558
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.1797, Val Loss: 1.1905, Test Loss: 1.1905, Val Acc: 0.5615, Test Acc: 0.5615
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.1705, Val Loss: 1.1956, Test Loss: 1.1956, Val Acc: 0.5610, Test Acc: 0.5610

Epoch 7, Train Loss: 1.1592, Val Loss: 1.1786, Test Loss: 1.1786, Val Acc: 0.5662, Test Acc: 0.5662
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.1473, Val Loss: 1.1834, Test Loss: 1.1834, Val Acc: 0.5669, Test Acc: 0.5669
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.1402, Val Loss: 1.1907, Test Loss: 1.1907, Val Acc: 0.5603, Test Acc: 0.5603

Epoch 10, Train Loss: 1.1281, Val Loss: 1.1714, Test Loss: 1.1714, Val Acc: 0.5721, Test Acc: 0.5721
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.1220, Val Loss: 1.1754, Test Loss: 1.1754, Val Acc: 0.5689, Test Acc: 0.5689

Epoch 12, Train Loss: 1.1097, Val Loss: 1.1454, Test Loss: 1.1454, Val Acc: 0.5810, Test Acc: 0.5810
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 1.0967, Val Loss: 1.1437, Test Loss: 1.1437, Val Acc: 0.5846, Test Acc: 0.5846
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 1.0875, Val Loss: 1.1379, Test Loss: 1.1379, Val Acc: 0.5856, Test Acc: 0.5856
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 1.0756, Val Loss: 1.1244, Test Loss: 1.1244, Val Acc: 0.5933, Test Acc: 0.5933
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.0699, Val Loss: 1.1326, Test Loss: 1.1326, Val Acc: 0.5886, Test Acc: 0.5886

Epoch 17, Train Loss: 1.0635, Val Loss: 1.1316, Test Loss: 1.1316, Val Acc: 0.5904, Test Acc: 0.5904

Epoch 18, Train Loss: 1.0553, Val Loss: 1.1362, Test Loss: 1.1362, Val Acc: 0.5920, Test Acc: 0.5920

Epoch 19, Train Loss: 1.0454, Val Loss: 1.1275, Test Loss: 1.1275, Val Acc: 0.5897, Test Acc: 0.5897

Epoch 20, Train Loss: 1.0385, Val Loss: 1.1307, Test Loss: 1.1307, Val Acc: 0.5896, Test Acc: 0.5896

Epoch 21, Train Loss: 1.0338, Val Loss: 1.1310, Test Loss: 1.1310, Val Acc: 0.5932, Test Acc: 0.5932

Epoch 22, Train Loss: 0.9895, Val Loss: 1.1547, Test Loss: 1.1547, Val Acc: 0.5922, Test Acc: 0.5922

Epoch 23, Train Loss: 0.9757, Val Loss: 1.1548, Test Loss: 1.1548, Val Acc: 0.5977, Test Acc: 0.5977
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 24, Train Loss: 0.9657, Val Loss: 1.1772, Test Loss: 1.1772, Val Acc: 0.5921, Test Acc: 0.5921

Epoch 25, Train Loss: 0.9591, Val Loss: 1.1823, Test Loss: 1.1823, Val Acc: 0.5900, Test Acc: 0.5900

Epoch 26, Train Loss: 0.9475, Val Loss: 1.1816, Test Loss: 1.1816, Val Acc: 0.5893, Test Acc: 0.5893

Epoch 27, Train Loss: 0.9391, Val Loss: 1.1901, Test Loss: 1.1901, Val Acc: 0.5933, Test Acc: 0.5933

Epoch 28, Train Loss: 0.9316, Val Loss: 1.2114, Test Loss: 1.2114, Val Acc: 0.5897, Test Acc: 0.5897

Epoch 29, Train Loss: 0.9200, Val Loss: 1.1867, Test Loss: 1.1867, Val Acc: 0.5947, Test Acc: 0.5947

Epoch 30, Train Loss: 0.8802, Val Loss: 1.2515, Test Loss: 1.2515, Val Acc: 0.5931, Test Acc: 0.5931

Epoch 31, Train Loss: 0.8660, Val Loss: 1.2724, Test Loss: 1.2724, Val Acc: 0.5919, Test Acc: 0.5919

Epoch 32, Train Loss: 0.8549, Val Loss: 1.2817, Test Loss: 1.2817, Val Acc: 0.5918, Test Acc: 0.5918

Epoch 33, Train Loss: 0.8442, Val Loss: 1.2927, Test Loss: 1.2927, Val Acc: 0.5913, Test Acc: 0.5913

Epoch 34, Train Loss: 0.8345, Val Loss: 1.3285, Test Loss: 1.3285, Val Acc: 0.5905, Test Acc: 0.5905

Epoch 35, Train Loss: 0.8280, Val Loss: 1.3774, Test Loss: 1.3774, Val Acc: 0.5882, Test Acc: 0.5882

Epoch 36, Train Loss: 0.7989, Val Loss: 1.3685, Test Loss: 1.3685, Val Acc: 0.5915, Test Acc: 0.5915

Epoch 37, Train Loss: 0.7888, Val Loss: 1.3852, Test Loss: 1.3852, Val Acc: 0.5898, Test Acc: 0.5898

Epoch 38, Train Loss: 0.7823, Val Loss: 1.3828, Test Loss: 1.3828, Val Acc: 0.5895, Test Acc: 0.5895

Epoch 39, Train Loss: 0.7755, Val Loss: 1.4175, Test Loss: 1.4175, Val Acc: 0.5865, Test Acc: 0.5865

Epoch 40, Train Loss: 0.7694, Val Loss: 1.4470, Test Loss: 1.4470, Val Acc: 0.5884, Test Acc: 0.5884

Epoch 41, Train Loss: 0.7651, Val Loss: 1.4315, Test Loss: 1.4315, Val Acc: 0.5886, Test Acc: 0.5886

Epoch 42, Train Loss: 0.7482, Val Loss: 1.4531, Test Loss: 1.4531, Val Acc: 0.5891, Test Acc: 0.5891

Epoch 43, Train Loss: 0.7430, Val Loss: 1.4443, Test Loss: 1.4443, Val Acc: 0.5890, Test Acc: 0.5890

Epoch 44, Train Loss: 0.7392, Val Loss: 1.4713, Test Loss: 1.4713, Val Acc: 0.5878, Test Acc: 0.5878

Epoch 45, Train Loss: 0.7351, Val Loss: 1.5038, Test Loss: 1.5038, Val Acc: 0.5892, Test Acc: 0.5892

Epoch 46, Train Loss: 0.7315, Val Loss: 1.4921, Test Loss: 1.4921, Val Acc: 0.5889, Test Acc: 0.5889

Epoch 47, Train Loss: 0.7283, Val Loss: 1.4851, Test Loss: 1.4851, Val Acc: 0.5890, Test Acc: 0.5890

Epoch 48, Train Loss: 0.7210, Val Loss: 1.4991, Test Loss: 1.4991, Val Acc: 0.5886, Test Acc: 0.5886

Epoch 49, Train Loss: 0.7178, Val Loss: 1.5231, Test Loss: 1.5231, Val Acc: 0.5878, Test Acc: 0.5878

Epoch 50, Train Loss: 0.7166, Val Loss: 1.5356, Test Loss: 1.5356, Val Acc: 0.5884, Test Acc: 0.5884

Epoch 51, Train Loss: 0.7137, Val Loss: 1.5149, Test Loss: 1.5149, Val Acc: 0.5888, Test Acc: 0.5888

Epoch 52, Train Loss: 0.7117, Val Loss: 1.5086, Test Loss: 1.5086, Val Acc: 0.5892, Test Acc: 0.5892

Epoch 53, Train Loss: 0.7112, Val Loss: 1.5247, Test Loss: 1.5247, Val Acc: 0.5886, Test Acc: 0.5886

Epoch 54, Train Loss: 0.7066, Val Loss: 1.5423, Test Loss: 1.5423, Val Acc: 0.5884, Test Acc: 0.5884

Epoch 55, Train Loss: 0.7050, Val Loss: 1.5520, Test Loss: 1.5520, Val Acc: 0.5875, Test Acc: 0.5875

Epoch 56, Train Loss: 0.7035, Val Loss: 1.5482, Test Loss: 1.5482, Val Acc: 0.5876, Test Acc: 0.5876

Epoch 57, Train Loss: 0.7044, Val Loss: 1.5492, Test Loss: 1.5492, Val Acc: 0.5870, Test Acc: 0.5870

Epoch 58, Train Loss: 0.7021, Val Loss: 1.5681, Test Loss: 1.5681, Val Acc: 0.5871, Test Acc: 0.5871

Epoch 59, Train Loss: 0.7015, Val Loss: 1.5618, Test Loss: 1.5618, Val Acc: 0.5874, Test Acc: 0.5874

Epoch 60, Train Loss: 0.6992, Val Loss: 1.5595, Test Loss: 1.5595, Val Acc: 0.5874, Test Acc: 0.5874

Epoch 61, Train Loss: 0.6985, Val Loss: 1.5680, Test Loss: 1.5680, Val Acc: 0.5869, Test Acc: 0.5869

Epoch 62, Train Loss: 0.6986, Val Loss: 1.5602, Test Loss: 1.5602, Val Acc: 0.5875, Test Acc: 0.5875

Epoch 63, Train Loss: 0.6990, Val Loss: 1.5599, Test Loss: 1.5599, Val Acc: 0.5876, Test Acc: 0.5876

Epoch 64, Train Loss: 0.6981, Val Loss: 1.5601, Test Loss: 1.5601, Val Acc: 0.5875, Test Acc: 0.5875

Epoch 65, Train Loss: 0.6947, Val Loss: 1.5684, Test Loss: 1.5684, Val Acc: 0.5876, Test Acc: 0.5876

Epoch 66, Train Loss: 0.6959, Val Loss: 1.5689, Test Loss: 1.5689, Val Acc: 0.5870, Test Acc: 0.5870

Epoch 67, Train Loss: 0.6960, Val Loss: 1.5671, Test Loss: 1.5671, Val Acc: 0.5867, Test Acc: 0.5867

Epoch 68, Train Loss: 0.6952, Val Loss: 1.5682, Test Loss: 1.5682, Val Acc: 0.5871, Test Acc: 0.5871

Epoch 69, Train Loss: 0.6954, Val Loss: 1.5720, Test Loss: 1.5720, Val Acc: 0.5871, Test Acc: 0.5871

Epoch 70, Train Loss: 0.6937, Val Loss: 1.5644, Test Loss: 1.5644, Val Acc: 0.5869, Test Acc: 0.5869

Epoch 71, Train Loss: 0.6932, Val Loss: 1.5765, Test Loss: 1.5765, Val Acc: 0.5873, Test Acc: 0.5873

Epoch 72, Train Loss: 0.6944, Val Loss: 1.5693, Test Loss: 1.5693, Val Acc: 0.5870, Test Acc: 0.5870

Epoch 73, Train Loss: 0.6931, Val Loss: 1.5724, Test Loss: 1.5724, Val Acc: 0.5870, Test Acc: 0.5870
Time to best model: 968.26 seconds
