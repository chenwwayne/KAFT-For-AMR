Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 2.1422, Val Loss: 1.9907, Test Loss: 1.9898, Val Acc: 0.2438, Test Acc: 0.2415
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.9372, Val Loss: 1.8664, Test Loss: 1.8649, Val Acc: 0.2910, Test Acc: 0.2915
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.8294, Val Loss: 1.7738, Test Loss: 1.7735, Val Acc: 0.3149, Test Acc: 0.3161
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.7573, Val Loss: 1.7324, Test Loss: 1.7279, Val Acc: 0.3277, Test Acc: 0.3302
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.7243, Val Loss: 1.7089, Test Loss: 1.7049, Val Acc: 0.3421, Test Acc: 0.3425
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.6959, Val Loss: 1.6670, Test Loss: 1.6625, Val Acc: 0.3514, Test Acc: 0.3555
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.6657, Val Loss: 1.6639, Test Loss: 1.6619, Val Acc: 0.3628, Test Acc: 0.3650
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.6233, Val Loss: 1.6174, Test Loss: 1.6114, Val Acc: 0.3790, Test Acc: 0.3787
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.5911, Val Loss: 1.5770, Test Loss: 1.5716, Val Acc: 0.3928, Test Acc: 0.3941
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.5610, Val Loss: 1.5519, Test Loss: 1.5507, Val Acc: 0.3999, Test Acc: 0.3991
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 1.5357, Val Loss: 1.5306, Test Loss: 1.5265, Val Acc: 0.4086, Test Acc: 0.4083
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.5156, Val Loss: 1.5261, Test Loss: 1.5236, Val Acc: 0.4038, Test Acc: 0.4078

Epoch 12, Train Loss: 1.4985, Val Loss: 1.5012, Test Loss: 1.5001, Val Acc: 0.4211, Test Acc: 0.4205
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 1.4713, Val Loss: 1.4343, Test Loss: 1.4344, Val Acc: 0.4555, Test Acc: 0.4554
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 1.3883, Val Loss: 1.3884, Test Loss: 1.3873, Val Acc: 0.4778, Test Acc: 0.4798
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 1.3670, Val Loss: 1.3635, Test Loss: 1.3617, Val Acc: 0.4874, Test Acc: 0.4905
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.3465, Val Loss: 1.3499, Test Loss: 1.3493, Val Acc: 0.4926, Test Acc: 0.4943
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 1.3397, Val Loss: 1.3396, Test Loss: 1.3382, Val Acc: 0.4953, Test Acc: 0.4959
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 18, Train Loss: 1.3277, Val Loss: 1.3309, Test Loss: 1.3316, Val Acc: 0.4984, Test Acc: 0.4982
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 19, Train Loss: 1.3177, Val Loss: 1.3113, Test Loss: 1.3106, Val Acc: 0.5058, Test Acc: 0.5084
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 20, Train Loss: 1.3070, Val Loss: 1.3087, Test Loss: 1.3054, Val Acc: 0.5041, Test Acc: 0.5065

Epoch 21, Train Loss: 1.2949, Val Loss: 1.3060, Test Loss: 1.3040, Val Acc: 0.5058, Test Acc: 0.5067

Epoch 22, Train Loss: 1.2886, Val Loss: 1.2877, Test Loss: 1.2867, Val Acc: 0.5095, Test Acc: 0.5104
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 23, Train Loss: 1.2766, Val Loss: 1.2950, Test Loss: 1.2911, Val Acc: 0.5077, Test Acc: 0.5084

Epoch 24, Train Loss: 1.2643, Val Loss: 1.2765, Test Loss: 1.2749, Val Acc: 0.5137, Test Acc: 0.5177
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 25, Train Loss: 1.2570, Val Loss: 1.2764, Test Loss: 1.2748, Val Acc: 0.5139, Test Acc: 0.5150
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 26, Train Loss: 1.2463, Val Loss: 1.2496, Test Loss: 1.2486, Val Acc: 0.5268, Test Acc: 0.5305
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 27, Train Loss: 1.2362, Val Loss: 1.2762, Test Loss: 1.2734, Val Acc: 0.5149, Test Acc: 0.5164

Epoch 28, Train Loss: 1.2318, Val Loss: 1.2289, Test Loss: 1.2254, Val Acc: 0.5340, Test Acc: 0.5336
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 29, Train Loss: 1.2224, Val Loss: 1.2260, Test Loss: 1.2255, Val Acc: 0.5328, Test Acc: 0.5349

Epoch 30, Train Loss: 1.2177, Val Loss: 1.2206, Test Loss: 1.2207, Val Acc: 0.5357, Test Acc: 0.5382
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 31, Train Loss: 1.2112, Val Loss: 1.2188, Test Loss: 1.2139, Val Acc: 0.5347, Test Acc: 0.5366

Epoch 32, Train Loss: 1.2070, Val Loss: 1.2183, Test Loss: 1.2166, Val Acc: 0.5357, Test Acc: 0.5344

Epoch 33, Train Loss: 1.2024, Val Loss: 1.2061, Test Loss: 1.2048, Val Acc: 0.5405, Test Acc: 0.5428
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 34, Train Loss: 1.2012, Val Loss: 1.2526, Test Loss: 1.2508, Val Acc: 0.5234, Test Acc: 0.5246

Epoch 35, Train Loss: 1.1942, Val Loss: 1.2065, Test Loss: 1.2067, Val Acc: 0.5392, Test Acc: 0.5402

Epoch 36, Train Loss: 1.1931, Val Loss: 1.2032, Test Loss: 1.2031, Val Acc: 0.5421, Test Acc: 0.5421
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 37, Train Loss: 1.1902, Val Loss: 1.1977, Test Loss: 1.1961, Val Acc: 0.5434, Test Acc: 0.5442
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 38, Train Loss: 1.1827, Val Loss: 1.2040, Test Loss: 1.2058, Val Acc: 0.5401, Test Acc: 0.5382

Epoch 39, Train Loss: 1.1845, Val Loss: 1.2072, Test Loss: 1.2074, Val Acc: 0.5377, Test Acc: 0.5400

Epoch 40, Train Loss: 1.1770, Val Loss: 1.2004, Test Loss: 1.2020, Val Acc: 0.5410, Test Acc: 0.5440

Epoch 41, Train Loss: 1.1784, Val Loss: 1.1998, Test Loss: 1.1983, Val Acc: 0.5418, Test Acc: 0.5424

Epoch 42, Train Loss: 1.1746, Val Loss: 1.1898, Test Loss: 1.1915, Val Acc: 0.5457, Test Acc: 0.5465
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 43, Train Loss: 1.1740, Val Loss: 1.1964, Test Loss: 1.1992, Val Acc: 0.5472, Test Acc: 0.5457
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 44, Train Loss: 1.1699, Val Loss: 1.2054, Test Loss: 1.2034, Val Acc: 0.5410, Test Acc: 0.5415

Epoch 45, Train Loss: 1.1662, Val Loss: 1.2090, Test Loss: 1.2079, Val Acc: 0.5412, Test Acc: 0.5427

Epoch 46, Train Loss: 1.1645, Val Loss: 1.2213, Test Loss: 1.2227, Val Acc: 0.5326, Test Acc: 0.5349

Epoch 47, Train Loss: 1.1629, Val Loss: 1.2006, Test Loss: 1.1996, Val Acc: 0.5443, Test Acc: 0.5443

Epoch 48, Train Loss: 1.1589, Val Loss: 1.1941, Test Loss: 1.1933, Val Acc: 0.5460, Test Acc: 0.5455

Epoch 49, Train Loss: 1.1599, Val Loss: 1.2269, Test Loss: 1.2262, Val Acc: 0.5356, Test Acc: 0.5362

Epoch 50, Train Loss: 1.1559, Val Loss: 1.1884, Test Loss: 1.1915, Val Acc: 0.5485, Test Acc: 0.5467
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 51, Train Loss: 1.1524, Val Loss: 1.2056, Test Loss: 1.2062, Val Acc: 0.5438, Test Acc: 0.5435

Epoch 52, Train Loss: 1.1540, Val Loss: 1.2007, Test Loss: 1.2030, Val Acc: 0.5420, Test Acc: 0.5419

Epoch 53, Train Loss: 1.1501, Val Loss: 1.2006, Test Loss: 1.2011, Val Acc: 0.5456, Test Acc: 0.5451

Epoch 54, Train Loss: 1.1458, Val Loss: 1.2363, Test Loss: 1.2409, Val Acc: 0.5352, Test Acc: 0.5341

Epoch 55, Train Loss: 1.1441, Val Loss: 1.2151, Test Loss: 1.2181, Val Acc: 0.5395, Test Acc: 0.5389

Epoch 56, Train Loss: 1.1432, Val Loss: 1.2007, Test Loss: 1.2010, Val Acc: 0.5426, Test Acc: 0.5449

Epoch 57, Train Loss: 1.1430, Val Loss: 1.1895, Test Loss: 1.1891, Val Acc: 0.5488, Test Acc: 0.5490
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 58, Train Loss: 1.1385, Val Loss: 1.2102, Test Loss: 1.2127, Val Acc: 0.5431, Test Acc: 0.5454

Epoch 59, Train Loss: 1.1375, Val Loss: 1.2073, Test Loss: 1.2085, Val Acc: 0.5471, Test Acc: 0.5476

Epoch 60, Train Loss: 1.1336, Val Loss: 1.1982, Test Loss: 1.1994, Val Acc: 0.5459, Test Acc: 0.5452

Epoch 61, Train Loss: 1.1324, Val Loss: 1.2063, Test Loss: 1.2117, Val Acc: 0.5429, Test Acc: 0.5419

Epoch 62, Train Loss: 1.1300, Val Loss: 1.2088, Test Loss: 1.2116, Val Acc: 0.5439, Test Acc: 0.5435

Epoch 63, Train Loss: 1.1276, Val Loss: 1.2305, Test Loss: 1.2323, Val Acc: 0.5405, Test Acc: 0.5400

Epoch 64, Train Loss: 1.1254, Val Loss: 1.2230, Test Loss: 1.2230, Val Acc: 0.5370, Test Acc: 0.5401

Epoch 65, Train Loss: 1.1221, Val Loss: 1.2092, Test Loss: 1.2136, Val Acc: 0.5476, Test Acc: 0.5467

Epoch 66, Train Loss: 1.1225, Val Loss: 1.2170, Test Loss: 1.2210, Val Acc: 0.5424, Test Acc: 0.5416

Epoch 67, Train Loss: 1.1188, Val Loss: 1.2396, Test Loss: 1.2404, Val Acc: 0.5370, Test Acc: 0.5380

Epoch 68, Train Loss: 1.1197, Val Loss: 1.2158, Test Loss: 1.2190, Val Acc: 0.5451, Test Acc: 0.5436

Epoch 69, Train Loss: 1.1133, Val Loss: 1.2126, Test Loss: 1.2146, Val Acc: 0.5449, Test Acc: 0.5443

Epoch 70, Train Loss: 1.1137, Val Loss: 1.2130, Test Loss: 1.2182, Val Acc: 0.5444, Test Acc: 0.5443

Epoch 71, Train Loss: 1.1090, Val Loss: 1.2222, Test Loss: 1.2219, Val Acc: 0.5459, Test Acc: 0.5435

Epoch 72, Train Loss: 1.1104, Val Loss: 1.2272, Test Loss: 1.2314, Val Acc: 0.5436, Test Acc: 0.5410

Epoch 73, Train Loss: 1.1034, Val Loss: 1.2237, Test Loss: 1.2301, Val Acc: 0.5483, Test Acc: 0.5448
Time to best model: 6259.67 seconds
Test score after training: 0.5448
Throughput after training: 6242.72 samples/second
Latency after training: 0.16 ms/sample

Result:
{'val': 0.5487954545454545, 'test': 0.549, 'epoch': 57}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0936
SNR = -18: Acc =  0.0914
SNR = -16: Acc =  0.0927
SNR = -14: Acc =  0.1136
SNR = -12: Acc =  0.1550
SNR = -10: Acc =  0.2227
SNR =  -8: Acc =  0.3200
SNR =  -6: Acc =  0.4318
SNR =  -4: Acc =  0.5382
SNR =  -2: Acc =  0.6800
SNR =   0: Acc =  0.7523
SNR =   2: Acc =  0.7941
SNR =   4: Acc =  0.8164
SNR =   6: Acc =  0.8245
SNR =   8: Acc =  0.8255
SNR =  10: Acc =  0.8336
SNR =  12: Acc =  0.8318
SNR =  14: Acc =  0.8323
SNR =  16: Acc =  0.8200
SNR =  18: Acc =  0.8273
==========================

