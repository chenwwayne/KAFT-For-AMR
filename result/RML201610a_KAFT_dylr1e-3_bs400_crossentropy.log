Using device: cuda
Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 2.1318, Val Loss: 1.9487, Test Loss: 1.9525, Val Acc: 0.2585, Test Acc: 0.2578
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 114.30 seconds
Epoch 1, Train Loss: 1.9200, Val Loss: 1.8563, Test Loss: 1.8557, Val Acc: 0.2897, Test Acc: 0.2919
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 233.39 seconds
Epoch 2, Train Loss: 1.8169, Val Loss: 1.7617, Test Loss: 1.7630, Val Acc: 0.3231, Test Acc: 0.3212
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 352.43 seconds
Epoch 3, Train Loss: 1.7446, Val Loss: 1.7081, Test Loss: 1.7034, Val Acc: 0.3403, Test Acc: 0.3426
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 471.48 seconds
Epoch 4, Train Loss: 1.6971, Val Loss: 1.6723, Test Loss: 1.6711, Val Acc: 0.3504, Test Acc: 0.3476
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 591.20 seconds
Epoch 5, Train Loss: 1.6448, Val Loss: 1.6178, Test Loss: 1.6157, Val Acc: 0.3795, Test Acc: 0.3826
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 710.95 seconds
Epoch 6, Train Loss: 1.5394, Val Loss: 1.4376, Test Loss: 1.4351, Val Acc: 0.4587, Test Acc: 0.4603
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 830.60 seconds
Epoch 7, Train Loss: 1.4442, Val Loss: 1.4219, Test Loss: 1.4197, Val Acc: 0.4673, Test Acc: 0.4693
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 949.48 seconds
Epoch 8, Train Loss: 1.3967, Val Loss: 1.3877, Test Loss: 1.3864, Val Acc: 0.4798, Test Acc: 0.4822
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1068.11 seconds
Epoch 9, Train Loss: 1.3537, Val Loss: 1.3148, Test Loss: 1.3108, Val Acc: 0.5048, Test Acc: 0.5047
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1186.70 seconds
Epoch 10, Train Loss: 1.3211, Val Loss: 1.2908, Test Loss: 1.2885, Val Acc: 0.5115, Test Acc: 0.5113
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1305.77 seconds
Epoch 11, Train Loss: 1.2954, Val Loss: 1.2810, Test Loss: 1.2799, Val Acc: 0.5163, Test Acc: 0.5147
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1424.99 seconds
Epoch 12, Train Loss: 1.2717, Val Loss: 1.2717, Test Loss: 1.2707, Val Acc: 0.5184, Test Acc: 0.5215
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1544.09 seconds
Epoch 13, Train Loss: 1.2614, Val Loss: 1.2682, Test Loss: 1.2663, Val Acc: 0.5181, Test Acc: 0.5188

Time to best model: 1544.09 seconds
Epoch 14, Train Loss: 1.2431, Val Loss: 1.2354, Test Loss: 1.2342, Val Acc: 0.5310, Test Acc: 0.5313
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1782.36 seconds
Epoch 15, Train Loss: 1.2367, Val Loss: 1.2313, Test Loss: 1.2279, Val Acc: 0.5347, Test Acc: 0.5340
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1902.09 seconds
Epoch 16, Train Loss: 1.2250, Val Loss: 1.2203, Test Loss: 1.2214, Val Acc: 0.5365, Test Acc: 0.5340
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2022.06 seconds
Epoch 17, Train Loss: 1.2201, Val Loss: 1.2147, Test Loss: 1.2162, Val Acc: 0.5394, Test Acc: 0.5387
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2141.60 seconds
Epoch 18, Train Loss: 1.2106, Val Loss: 1.2388, Test Loss: 1.2415, Val Acc: 0.5315, Test Acc: 0.5312

Time to best model: 2141.60 seconds
Epoch 19, Train Loss: 1.2089, Val Loss: 1.2271, Test Loss: 1.2272, Val Acc: 0.5326, Test Acc: 0.5334

Time to best model: 2141.60 seconds
Epoch 20, Train Loss: 1.2025, Val Loss: 1.2102, Test Loss: 1.2132, Val Acc: 0.5396, Test Acc: 0.5395
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2498.36 seconds
Epoch 21, Train Loss: 1.1992, Val Loss: 1.2100, Test Loss: 1.2092, Val Acc: 0.5413, Test Acc: 0.5409
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2617.32 seconds
Epoch 22, Train Loss: 1.1944, Val Loss: 1.2112, Test Loss: 1.2125, Val Acc: 0.5412, Test Acc: 0.5400

Time to best model: 2617.32 seconds
Epoch 23, Train Loss: 1.1884, Val Loss: 1.1961, Test Loss: 1.2002, Val Acc: 0.5425, Test Acc: 0.5424
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2854.97 seconds
Epoch 24, Train Loss: 1.1878, Val Loss: 1.2094, Test Loss: 1.2113, Val Acc: 0.5392, Test Acc: 0.5386

Time to best model: 2854.97 seconds
Epoch 25, Train Loss: 1.1857, Val Loss: 1.2070, Test Loss: 1.2049, Val Acc: 0.5420, Test Acc: 0.5415

Time to best model: 2854.97 seconds
Epoch 26, Train Loss: 1.1808, Val Loss: 1.1976, Test Loss: 1.1985, Val Acc: 0.5451, Test Acc: 0.5453
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3212.63 seconds
Epoch 27, Train Loss: 1.1771, Val Loss: 1.1932, Test Loss: 1.1953, Val Acc: 0.5442, Test Acc: 0.5433

Time to best model: 3212.63 seconds
Epoch 28, Train Loss: 1.1739, Val Loss: 1.2007, Test Loss: 1.2051, Val Acc: 0.5466, Test Acc: 0.5453
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3451.65 seconds
Epoch 29, Train Loss: 1.1738, Val Loss: 1.1966, Test Loss: 1.1969, Val Acc: 0.5474, Test Acc: 0.5461
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3570.75 seconds
Epoch 30, Train Loss: 1.1716, Val Loss: 1.1926, Test Loss: 1.1927, Val Acc: 0.5467, Test Acc: 0.5479

Time to best model: 3570.75 seconds
Epoch 31, Train Loss: 1.1699, Val Loss: 1.1861, Test Loss: 1.1876, Val Acc: 0.5509, Test Acc: 0.5483
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3808.21 seconds
Epoch 32, Train Loss: 1.1642, Val Loss: 1.2035, Test Loss: 1.2015, Val Acc: 0.5453, Test Acc: 0.5488

Time to best model: 3808.21 seconds
Epoch 33, Train Loss: 1.1619, Val Loss: 1.1907, Test Loss: 1.1962, Val Acc: 0.5495, Test Acc: 0.5476

Time to best model: 3808.21 seconds
Epoch 34, Train Loss: 1.1598, Val Loss: 1.1941, Test Loss: 1.1985, Val Acc: 0.5466, Test Acc: 0.5441

Time to best model: 3808.21 seconds
Epoch 35, Train Loss: 1.1571, Val Loss: 1.1874, Test Loss: 1.1916, Val Acc: 0.5514, Test Acc: 0.5501
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4284.78 seconds
Epoch 36, Train Loss: 1.1553, Val Loss: 1.1923, Test Loss: 1.1966, Val Acc: 0.5491, Test Acc: 0.5453

Time to best model: 4284.78 seconds
Epoch 37, Train Loss: 1.1539, Val Loss: 1.1846, Test Loss: 1.1861, Val Acc: 0.5519, Test Acc: 0.5514
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4523.87 seconds
Epoch 38, Train Loss: 1.1520, Val Loss: 1.2014, Test Loss: 1.2032, Val Acc: 0.5475, Test Acc: 0.5467

Time to best model: 4523.87 seconds
Epoch 39, Train Loss: 1.1485, Val Loss: 1.1867, Test Loss: 1.1891, Val Acc: 0.5539, Test Acc: 0.5517
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4762.82 seconds
Epoch 40, Train Loss: 1.1448, Val Loss: 1.2026, Test Loss: 1.2026, Val Acc: 0.5475, Test Acc: 0.5478

Time to best model: 4762.82 seconds
Epoch 41, Train Loss: 1.1427, Val Loss: 1.1874, Test Loss: 1.1888, Val Acc: 0.5509, Test Acc: 0.5502

Time to best model: 4762.82 seconds
Epoch 42, Train Loss: 1.1416, Val Loss: 1.1989, Test Loss: 1.2020, Val Acc: 0.5497, Test Acc: 0.5479

Time to best model: 4762.82 seconds
Epoch 43, Train Loss: 1.1408, Val Loss: 1.1963, Test Loss: 1.1983, Val Acc: 0.5480, Test Acc: 0.5486

Time to best model: 4762.82 seconds
Epoch 44, Train Loss: 1.1365, Val Loss: 1.1902, Test Loss: 1.1919, Val Acc: 0.5502, Test Acc: 0.5479

Time to best model: 4762.82 seconds
Epoch 45, Train Loss: 1.1363, Val Loss: 1.2039, Test Loss: 1.2069, Val Acc: 0.5487, Test Acc: 0.5479

Time to best model: 4762.82 seconds
Epoch 46, Train Loss: 1.1014, Val Loss: 1.1851, Test Loss: 1.1859, Val Acc: 0.5546, Test Acc: 0.5547
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5596.41 seconds
Epoch 47, Train Loss: 1.0937, Val Loss: 1.2001, Test Loss: 1.2012, Val Acc: 0.5505, Test Acc: 0.5509

Time to best model: 5596.41 seconds
Epoch 48, Train Loss: 1.0908, Val Loss: 1.1927, Test Loss: 1.1936, Val Acc: 0.5533, Test Acc: 0.5528

Time to best model: 5596.41 seconds
Epoch 49, Train Loss: 1.0879, Val Loss: 1.2005, Test Loss: 1.2035, Val Acc: 0.5538, Test Acc: 0.5531

Time to best model: 5596.41 seconds
Epoch 50, Train Loss: 1.0844, Val Loss: 1.2183, Test Loss: 1.2158, Val Acc: 0.5475, Test Acc: 0.5483

Time to best model: 5596.41 seconds
Epoch 51, Train Loss: 1.0839, Val Loss: 1.2248, Test Loss: 1.2309, Val Acc: 0.5455, Test Acc: 0.5446

Time to best model: 5596.41 seconds
Epoch 52, Train Loss: 1.0811, Val Loss: 1.2035, Test Loss: 1.2038, Val Acc: 0.5530, Test Acc: 0.5527

Time to best model: 5596.41 seconds
Epoch 53, Train Loss: 1.0574, Val Loss: 1.2183, Test Loss: 1.2219, Val Acc: 0.5524, Test Acc: 0.5500

Time to best model: 5596.41 seconds
Epoch 54, Train Loss: 1.0520, Val Loss: 1.2125, Test Loss: 1.2129, Val Acc: 0.5546, Test Acc: 0.5521

Time to best model: 5596.41 seconds
Epoch 55, Train Loss: 1.0493, Val Loss: 1.2257, Test Loss: 1.2254, Val Acc: 0.5506, Test Acc: 0.5515

Time to best model: 5596.41 seconds
Epoch 56, Train Loss: 1.0454, Val Loss: 1.2208, Test Loss: 1.2220, Val Acc: 0.5528, Test Acc: 0.5529

Time to best model: 5596.41 seconds
Epoch 57, Train Loss: 1.0442, Val Loss: 1.2197, Test Loss: 1.2215, Val Acc: 0.5536, Test Acc: 0.5529

Time to best model: 5596.41 seconds
Epoch 58, Train Loss: 1.0406, Val Loss: 1.2346, Test Loss: 1.2344, Val Acc: 0.5519, Test Acc: 0.5515

Time to best model: 5596.41 seconds
Epoch 59, Train Loss: 1.0273, Val Loss: 1.2356, Test Loss: 1.2337, Val Acc: 0.5507, Test Acc: 0.5506

Time to best model: 5596.41 seconds
Epoch 60, Train Loss: 1.0226, Val Loss: 1.2408, Test Loss: 1.2395, Val Acc: 0.5504, Test Acc: 0.5503

Time to best model: 5596.41 seconds
Epoch 61, Train Loss: 1.0212, Val Loss: 1.2478, Test Loss: 1.2488, Val Acc: 0.5512, Test Acc: 0.5501

Time to best model: 5596.41 seconds
Epoch 62, Train Loss: 1.0194, Val Loss: 1.2478, Test Loss: 1.2474, Val Acc: 0.5521, Test Acc: 0.5519
Test score after training: 0.5519
Throughput after training: 6018.80 samples/second
Latency after training: 0.17 ms/sample

Result:
{'val': 0.5546363636363636, 'test': 0.5547045454545455, 'epoch': 46}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0964
SNR = -18: Acc =  0.0995
SNR = -16: Acc =  0.1023
SNR = -14: Acc =  0.1177
SNR = -12: Acc =  0.1550
SNR = -10: Acc =  0.2050
SNR =  -8: Acc =  0.3118
SNR =  -6: Acc =  0.4673
SNR =  -4: Acc =  0.5541
SNR =  -2: Acc =  0.6950
SNR =   0: Acc =  0.7691
SNR =   2: Acc =  0.8000
SNR =   4: Acc =  0.8295
SNR =   6: Acc =  0.8309
SNR =   8: Acc =  0.8250
SNR =  10: Acc =  0.8318
SNR =  12: Acc =  0.8427
SNR =  14: Acc =  0.8395
SNR =  16: Acc =  0.8268
SNR =  18: Acc =  0.8386
==========================

