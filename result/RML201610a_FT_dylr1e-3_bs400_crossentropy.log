Using device: cuda
Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 2.1422, Val Loss: 1.9907, Test Loss: 1.9898, Val Acc: 0.2441, Test Acc: 0.2415
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 99.33 seconds
Epoch 1, Train Loss: 1.9372, Val Loss: 1.8664, Test Loss: 1.8649, Val Acc: 0.2910, Test Acc: 0.2915
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 212.87 seconds
Epoch 2, Train Loss: 1.8294, Val Loss: 1.7738, Test Loss: 1.7735, Val Acc: 0.3151, Test Acc: 0.3161
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 331.26 seconds
Epoch 3, Train Loss: 1.7573, Val Loss: 1.7324, Test Loss: 1.7279, Val Acc: 0.3282, Test Acc: 0.3301
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 449.45 seconds
Epoch 4, Train Loss: 1.7243, Val Loss: 1.7089, Test Loss: 1.7049, Val Acc: 0.3420, Test Acc: 0.3426
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 567.53 seconds
Epoch 5, Train Loss: 1.6959, Val Loss: 1.6670, Test Loss: 1.6625, Val Acc: 0.3516, Test Acc: 0.3558
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 685.56 seconds
Epoch 6, Train Loss: 1.6657, Val Loss: 1.6639, Test Loss: 1.6619, Val Acc: 0.3627, Test Acc: 0.3647
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 804.16 seconds
Epoch 7, Train Loss: 1.6233, Val Loss: 1.6174, Test Loss: 1.6114, Val Acc: 0.3791, Test Acc: 0.3789
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 922.35 seconds
Epoch 8, Train Loss: 1.5911, Val Loss: 1.5770, Test Loss: 1.5716, Val Acc: 0.3925, Test Acc: 0.3942
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1040.51 seconds
Epoch 9, Train Loss: 1.5610, Val Loss: 1.5519, Test Loss: 1.5507, Val Acc: 0.3997, Test Acc: 0.3990
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1159.86 seconds
Epoch 10, Train Loss: 1.5357, Val Loss: 1.5306, Test Loss: 1.5265, Val Acc: 0.4087, Test Acc: 0.4086
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1279.24 seconds
Epoch 11, Train Loss: 1.5156, Val Loss: 1.5261, Test Loss: 1.5236, Val Acc: 0.4050, Test Acc: 0.4081

Time to best model: 1279.24 seconds
Epoch 12, Train Loss: 1.4985, Val Loss: 1.5012, Test Loss: 1.5001, Val Acc: 0.4216, Test Acc: 0.4205
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1518.02 seconds
Epoch 13, Train Loss: 1.4713, Val Loss: 1.4343, Test Loss: 1.4344, Val Acc: 0.4559, Test Acc: 0.4562
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1636.26 seconds
Epoch 14, Train Loss: 1.3883, Val Loss: 1.3884, Test Loss: 1.3873, Val Acc: 0.4782, Test Acc: 0.4796
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1754.44 seconds
Epoch 15, Train Loss: 1.3670, Val Loss: 1.3635, Test Loss: 1.3617, Val Acc: 0.4878, Test Acc: 0.4906
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1872.42 seconds
Epoch 16, Train Loss: 1.3465, Val Loss: 1.3499, Test Loss: 1.3493, Val Acc: 0.4930, Test Acc: 0.4942
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1990.35 seconds
Epoch 17, Train Loss: 1.3397, Val Loss: 1.3396, Test Loss: 1.3382, Val Acc: 0.4957, Test Acc: 0.4969
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2108.79 seconds
Epoch 18, Train Loss: 1.3277, Val Loss: 1.3309, Test Loss: 1.3316, Val Acc: 0.4989, Test Acc: 0.4985
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2227.21 seconds
Epoch 19, Train Loss: 1.3177, Val Loss: 1.3113, Test Loss: 1.3106, Val Acc: 0.5061, Test Acc: 0.5085
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2345.97 seconds
Epoch 20, Train Loss: 1.3070, Val Loss: 1.3087, Test Loss: 1.3054, Val Acc: 0.5045, Test Acc: 0.5068

Time to best model: 2345.97 seconds
Epoch 21, Train Loss: 1.2949, Val Loss: 1.3060, Test Loss: 1.3040, Val Acc: 0.5057, Test Acc: 0.5070

Time to best model: 2345.97 seconds
Epoch 22, Train Loss: 1.2886, Val Loss: 1.2877, Test Loss: 1.2867, Val Acc: 0.5113, Test Acc: 0.5120
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2703.36 seconds
Epoch 23, Train Loss: 1.2766, Val Loss: 1.2950, Test Loss: 1.2911, Val Acc: 0.5072, Test Acc: 0.5077

Time to best model: 2703.36 seconds
Epoch 24, Train Loss: 1.2643, Val Loss: 1.2765, Test Loss: 1.2749, Val Acc: 0.5153, Test Acc: 0.5182
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2939.53 seconds
Epoch 25, Train Loss: 1.2570, Val Loss: 1.2764, Test Loss: 1.2748, Val Acc: 0.5140, Test Acc: 0.5137

Time to best model: 2939.53 seconds
Epoch 26, Train Loss: 1.2463, Val Loss: 1.2496, Test Loss: 1.2486, Val Acc: 0.5270, Test Acc: 0.5301
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3175.16 seconds
Epoch 27, Train Loss: 1.2362, Val Loss: 1.2762, Test Loss: 1.2734, Val Acc: 0.5154, Test Acc: 0.5168

Time to best model: 3175.16 seconds
Epoch 28, Train Loss: 1.2318, Val Loss: 1.2289, Test Loss: 1.2254, Val Acc: 0.5334, Test Acc: 0.5330
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3411.63 seconds
Epoch 29, Train Loss: 1.2224, Val Loss: 1.2260, Test Loss: 1.2255, Val Acc: 0.5353, Test Acc: 0.5365
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3529.63 seconds
Epoch 30, Train Loss: 1.2177, Val Loss: 1.2206, Test Loss: 1.2207, Val Acc: 0.5362, Test Acc: 0.5383
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3648.83 seconds
Epoch 31, Train Loss: 1.2112, Val Loss: 1.2188, Test Loss: 1.2139, Val Acc: 0.5365, Test Acc: 0.5375
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3767.90 seconds
Epoch 32, Train Loss: 1.2070, Val Loss: 1.2183, Test Loss: 1.2166, Val Acc: 0.5364, Test Acc: 0.5355

Time to best model: 3767.90 seconds
Epoch 33, Train Loss: 1.2024, Val Loss: 1.2061, Test Loss: 1.2048, Val Acc: 0.5415, Test Acc: 0.5427
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4005.58 seconds
Epoch 34, Train Loss: 1.2012, Val Loss: 1.2526, Test Loss: 1.2508, Val Acc: 0.5252, Test Acc: 0.5255

Time to best model: 4005.58 seconds
Epoch 35, Train Loss: 1.1942, Val Loss: 1.2065, Test Loss: 1.2067, Val Acc: 0.5424, Test Acc: 0.5426
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4242.74 seconds
Epoch 36, Train Loss: 1.1931, Val Loss: 1.2032, Test Loss: 1.2031, Val Acc: 0.5444, Test Acc: 0.5428
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4360.58 seconds
Epoch 37, Train Loss: 1.1902, Val Loss: 1.1977, Test Loss: 1.1961, Val Acc: 0.5434, Test Acc: 0.5447

Time to best model: 4360.58 seconds
Epoch 38, Train Loss: 1.1827, Val Loss: 1.2040, Test Loss: 1.2058, Val Acc: 0.5418, Test Acc: 0.5405

Time to best model: 4360.58 seconds
Epoch 39, Train Loss: 1.1845, Val Loss: 1.2072, Test Loss: 1.2074, Val Acc: 0.5384, Test Acc: 0.5407

Time to best model: 4360.58 seconds
Epoch 40, Train Loss: 1.1770, Val Loss: 1.2004, Test Loss: 1.2020, Val Acc: 0.5415, Test Acc: 0.5440

Time to best model: 4360.58 seconds
Epoch 41, Train Loss: 1.1784, Val Loss: 1.1998, Test Loss: 1.1983, Val Acc: 0.5442, Test Acc: 0.5430

Time to best model: 4360.58 seconds
Epoch 42, Train Loss: 1.1746, Val Loss: 1.1898, Test Loss: 1.1915, Val Acc: 0.5486, Test Acc: 0.5472
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5073.80 seconds
Epoch 43, Train Loss: 1.1740, Val Loss: 1.1964, Test Loss: 1.1992, Val Acc: 0.5487, Test Acc: 0.5462
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5192.81 seconds
Epoch 44, Train Loss: 1.1699, Val Loss: 1.2054, Test Loss: 1.2034, Val Acc: 0.5430, Test Acc: 0.5430

Time to best model: 5192.81 seconds
Epoch 45, Train Loss: 1.1662, Val Loss: 1.2090, Test Loss: 1.2079, Val Acc: 0.5436, Test Acc: 0.5441

Time to best model: 5192.81 seconds
Epoch 46, Train Loss: 1.1645, Val Loss: 1.2213, Test Loss: 1.2227, Val Acc: 0.5335, Test Acc: 0.5356

Time to best model: 5192.81 seconds
Epoch 47, Train Loss: 1.1629, Val Loss: 1.2006, Test Loss: 1.1996, Val Acc: 0.5463, Test Acc: 0.5453

Time to best model: 5192.81 seconds
Epoch 48, Train Loss: 1.1589, Val Loss: 1.1941, Test Loss: 1.1933, Val Acc: 0.5487, Test Acc: 0.5467
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5784.87 seconds
Epoch 49, Train Loss: 1.1599, Val Loss: 1.2269, Test Loss: 1.2262, Val Acc: 0.5379, Test Acc: 0.5383

Time to best model: 5784.87 seconds
Epoch 50, Train Loss: 1.1277, Val Loss: 1.1810, Test Loss: 1.1837, Val Acc: 0.5549, Test Acc: 0.5531
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6021.65 seconds
Epoch 51, Train Loss: 1.1219, Val Loss: 1.1937, Test Loss: 1.1952, Val Acc: 0.5506, Test Acc: 0.5493

Time to best model: 6021.65 seconds
Epoch 52, Train Loss: 1.1203, Val Loss: 1.1779, Test Loss: 1.1805, Val Acc: 0.5553, Test Acc: 0.5531
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6260.26 seconds
Epoch 53, Train Loss: 1.1177, Val Loss: 1.1933, Test Loss: 1.1948, Val Acc: 0.5515, Test Acc: 0.5504

Time to best model: 6260.26 seconds
Epoch 54, Train Loss: 1.1138, Val Loss: 1.2033, Test Loss: 1.2060, Val Acc: 0.5485, Test Acc: 0.5488

Time to best model: 6260.26 seconds
Epoch 55, Train Loss: 1.1130, Val Loss: 1.1983, Test Loss: 1.2002, Val Acc: 0.5483, Test Acc: 0.5496

Time to best model: 6260.26 seconds
Epoch 56, Train Loss: 1.1089, Val Loss: 1.2045, Test Loss: 1.2093, Val Acc: 0.5485, Test Acc: 0.5467

Time to best model: 6260.26 seconds
Epoch 57, Train Loss: 1.1080, Val Loss: 1.1893, Test Loss: 1.1903, Val Acc: 0.5522, Test Acc: 0.5528

Time to best model: 6260.26 seconds
Epoch 58, Train Loss: 1.1057, Val Loss: 1.1974, Test Loss: 1.1999, Val Acc: 0.5498, Test Acc: 0.5502

Time to best model: 6260.26 seconds
Epoch 59, Train Loss: 1.0856, Val Loss: 1.2058, Test Loss: 1.2081, Val Acc: 0.5529, Test Acc: 0.5514

Time to best model: 6260.26 seconds
Epoch 60, Train Loss: 1.0805, Val Loss: 1.2047, Test Loss: 1.2073, Val Acc: 0.5523, Test Acc: 0.5506

Time to best model: 6260.26 seconds
Epoch 61, Train Loss: 1.0776, Val Loss: 1.2097, Test Loss: 1.2140, Val Acc: 0.5516, Test Acc: 0.5500

Time to best model: 6260.26 seconds
Epoch 62, Train Loss: 1.0748, Val Loss: 1.2079, Test Loss: 1.2103, Val Acc: 0.5530, Test Acc: 0.5509

Time to best model: 6260.26 seconds
Epoch 63, Train Loss: 1.0724, Val Loss: 1.2247, Test Loss: 1.2284, Val Acc: 0.5469, Test Acc: 0.5461

Time to best model: 6260.26 seconds
Epoch 64, Train Loss: 1.0722, Val Loss: 1.2126, Test Loss: 1.2163, Val Acc: 0.5507, Test Acc: 0.5513

Time to best model: 6260.26 seconds
Epoch 65, Train Loss: 1.0593, Val Loss: 1.2082, Test Loss: 1.2129, Val Acc: 0.5543, Test Acc: 0.5533

Time to best model: 6260.26 seconds
Epoch 66, Train Loss: 1.0553, Val Loss: 1.2194, Test Loss: 1.2242, Val Acc: 0.5508, Test Acc: 0.5509

Time to best model: 6260.26 seconds
Epoch 67, Train Loss: 1.0552, Val Loss: 1.2208, Test Loss: 1.2260, Val Acc: 0.5518, Test Acc: 0.5493

Time to best model: 6260.26 seconds
Epoch 68, Train Loss: 1.0534, Val Loss: 1.2252, Test Loss: 1.2288, Val Acc: 0.5503, Test Acc: 0.5495
Test score after training: 0.5495
Throughput after training: 9613.38 samples/second
Latency after training: 0.10 ms/sample

Result:
{'val': 0.5552727272727273, 'test': 0.5530909090909091, 'epoch': 52}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0927
SNR = -18: Acc =  0.0927
SNR = -16: Acc =  0.0968
SNR = -14: Acc =  0.1127
SNR = -12: Acc =  0.1505
SNR = -10: Acc =  0.2132
SNR =  -8: Acc =  0.3127
SNR =  -6: Acc =  0.4436
SNR =  -4: Acc =  0.5809
SNR =  -2: Acc =  0.7018
SNR =   0: Acc =  0.7673
SNR =   2: Acc =  0.7859
SNR =   4: Acc =  0.8082
SNR =   6: Acc =  0.8295
SNR =   8: Acc =  0.8264
SNR =  10: Acc =  0.8327
SNR =  12: Acc =  0.8455
SNR =  14: Acc =  0.8395
SNR =  16: Acc =  0.8232
SNR =  18: Acc =  0.8341
==========================

