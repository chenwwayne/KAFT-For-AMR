Using device: cuda
Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 2.1639, Val Loss: 1.9880, Test Loss: 1.9856, Val Acc: 0.2387, Test Acc: 0.2334
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 131.22 seconds
Epoch 1, Train Loss: 1.9293, Val Loss: 1.8793, Test Loss: 1.8817, Val Acc: 0.2807, Test Acc: 0.2780
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 261.88 seconds
Epoch 2, Train Loss: 1.8176, Val Loss: 1.7625, Test Loss: 1.7627, Val Acc: 0.3226, Test Acc: 0.3247
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 392.86 seconds
Epoch 3, Train Loss: 1.7314, Val Loss: 1.6906, Test Loss: 1.6894, Val Acc: 0.3397, Test Acc: 0.3404
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 524.38 seconds
Epoch 4, Train Loss: 1.6900, Val Loss: 1.6770, Test Loss: 1.6756, Val Acc: 0.3480, Test Acc: 0.3475
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 654.80 seconds
Epoch 5, Train Loss: 1.6574, Val Loss: 1.6577, Test Loss: 1.6556, Val Acc: 0.3542, Test Acc: 0.3548
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 785.97 seconds
Epoch 6, Train Loss: 1.6299, Val Loss: 1.6092, Test Loss: 1.6111, Val Acc: 0.3684, Test Acc: 0.3675
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 917.23 seconds
Epoch 7, Train Loss: 1.6032, Val Loss: 1.5966, Test Loss: 1.5930, Val Acc: 0.3791, Test Acc: 0.3795
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1048.26 seconds
Epoch 8, Train Loss: 1.5750, Val Loss: 1.5574, Test Loss: 1.5511, Val Acc: 0.3916, Test Acc: 0.3928
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1179.56 seconds
Epoch 9, Train Loss: 1.5377, Val Loss: 1.5141, Test Loss: 1.5118, Val Acc: 0.4079, Test Acc: 0.4094
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1310.28 seconds
Epoch 10, Train Loss: 1.5023, Val Loss: 1.4903, Test Loss: 1.4883, Val Acc: 0.4153, Test Acc: 0.4158
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1440.62 seconds
Epoch 11, Train Loss: 1.4723, Val Loss: 1.4695, Test Loss: 1.4667, Val Acc: 0.4238, Test Acc: 0.4244
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1571.21 seconds
Epoch 12, Train Loss: 1.4410, Val Loss: 1.4445, Test Loss: 1.4424, Val Acc: 0.4313, Test Acc: 0.4325
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1701.55 seconds
Epoch 13, Train Loss: 1.4209, Val Loss: 1.4027, Test Loss: 1.4033, Val Acc: 0.4451, Test Acc: 0.4451
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1833.05 seconds
Epoch 14, Train Loss: 1.3996, Val Loss: 1.3913, Test Loss: 1.3894, Val Acc: 0.4498, Test Acc: 0.4488
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 1963.31 seconds
Epoch 15, Train Loss: 1.3840, Val Loss: 1.3975, Test Loss: 1.3963, Val Acc: 0.4500, Test Acc: 0.4498
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2094.31 seconds
Epoch 16, Train Loss: 1.3741, Val Loss: 1.3969, Test Loss: 1.3976, Val Acc: 0.4570, Test Acc: 0.4535
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2224.61 seconds
Epoch 17, Train Loss: 1.3590, Val Loss: 1.3488, Test Loss: 1.3521, Val Acc: 0.4646, Test Acc: 0.4613
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2355.90 seconds
Epoch 18, Train Loss: 1.3488, Val Loss: 1.3510, Test Loss: 1.3502, Val Acc: 0.4660, Test Acc: 0.4658
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2486.99 seconds
Epoch 19, Train Loss: 1.3401, Val Loss: 1.3402, Test Loss: 1.3398, Val Acc: 0.4692, Test Acc: 0.4709
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2618.46 seconds
Epoch 20, Train Loss: 1.3344, Val Loss: 1.3509, Test Loss: 1.3495, Val Acc: 0.4688, Test Acc: 0.4680

Time to best model: 2618.46 seconds
Epoch 21, Train Loss: 1.3294, Val Loss: 1.3367, Test Loss: 1.3345, Val Acc: 0.4726, Test Acc: 0.4693
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 2880.96 seconds
Epoch 22, Train Loss: 1.3244, Val Loss: 1.3502, Test Loss: 1.3493, Val Acc: 0.4673, Test Acc: 0.4682

Time to best model: 2880.96 seconds
Epoch 23, Train Loss: 1.3212, Val Loss: 1.3312, Test Loss: 1.3311, Val Acc: 0.4735, Test Acc: 0.4727
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3142.91 seconds
Epoch 24, Train Loss: 1.3150, Val Loss: 1.3209, Test Loss: 1.3182, Val Acc: 0.4797, Test Acc: 0.4780
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3274.02 seconds
Epoch 25, Train Loss: 1.3105, Val Loss: 1.3068, Test Loss: 1.3074, Val Acc: 0.4844, Test Acc: 0.4851
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 3405.52 seconds
Epoch 26, Train Loss: 1.3075, Val Loss: 1.3088, Test Loss: 1.3098, Val Acc: 0.4830, Test Acc: 0.4841

Time to best model: 3405.52 seconds
Epoch 27, Train Loss: 1.3033, Val Loss: 1.3081, Test Loss: 1.3068, Val Acc: 0.4818, Test Acc: 0.4810

Time to best model: 3405.52 seconds
Epoch 28, Train Loss: 1.3002, Val Loss: 1.3155, Test Loss: 1.3129, Val Acc: 0.4841, Test Acc: 0.4817

Time to best model: 3405.52 seconds
Epoch 29, Train Loss: 1.2958, Val Loss: 1.3181, Test Loss: 1.3157, Val Acc: 0.4814, Test Acc: 0.4831

Time to best model: 3405.52 seconds
Epoch 30, Train Loss: 1.2929, Val Loss: 1.3138, Test Loss: 1.3117, Val Acc: 0.4838, Test Acc: 0.4844

Time to best model: 3405.52 seconds
Epoch 31, Train Loss: 1.2889, Val Loss: 1.3224, Test Loss: 1.3202, Val Acc: 0.4844, Test Acc: 0.4850

Time to best model: 3405.52 seconds
Epoch 32, Train Loss: 1.2588, Val Loss: 1.2899, Test Loss: 1.2915, Val Acc: 0.4993, Test Acc: 0.4981
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4322.11 seconds
Epoch 33, Train Loss: 1.2506, Val Loss: 1.2840, Test Loss: 1.2842, Val Acc: 0.5019, Test Acc: 0.5040
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4452.45 seconds
Epoch 34, Train Loss: 1.2451, Val Loss: 1.2856, Test Loss: 1.2901, Val Acc: 0.4993, Test Acc: 0.5006

Time to best model: 4452.45 seconds
Epoch 35, Train Loss: 1.2419, Val Loss: 1.2841, Test Loss: 1.2852, Val Acc: 0.5005, Test Acc: 0.5016

Time to best model: 4452.45 seconds
Epoch 36, Train Loss: 1.2390, Val Loss: 1.2746, Test Loss: 1.2755, Val Acc: 0.5090, Test Acc: 0.5093
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 4845.23 seconds
Epoch 37, Train Loss: 1.2349, Val Loss: 1.2781, Test Loss: 1.2791, Val Acc: 0.5082, Test Acc: 0.5094

Time to best model: 4845.23 seconds
Epoch 38, Train Loss: 1.2327, Val Loss: 1.2695, Test Loss: 1.2691, Val Acc: 0.5085, Test Acc: 0.5120

Time to best model: 4845.23 seconds
Epoch 39, Train Loss: 1.2252, Val Loss: 1.2771, Test Loss: 1.2785, Val Acc: 0.5027, Test Acc: 0.5029

Time to best model: 4845.23 seconds
Epoch 40, Train Loss: 1.2248, Val Loss: 1.2816, Test Loss: 1.2787, Val Acc: 0.5070, Test Acc: 0.5116

Time to best model: 4845.23 seconds
Epoch 41, Train Loss: 1.2226, Val Loss: 1.2708, Test Loss: 1.2701, Val Acc: 0.5119, Test Acc: 0.5141
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5499.87 seconds
Epoch 42, Train Loss: 1.2160, Val Loss: 1.2714, Test Loss: 1.2692, Val Acc: 0.5128, Test Acc: 0.5131
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 5630.49 seconds
Epoch 43, Train Loss: 1.2135, Val Loss: 1.2777, Test Loss: 1.2772, Val Acc: 0.5121, Test Acc: 0.5122

Time to best model: 5630.49 seconds
Epoch 44, Train Loss: 1.2094, Val Loss: 1.2721, Test Loss: 1.2709, Val Acc: 0.5107, Test Acc: 0.5112

Time to best model: 5630.49 seconds
Epoch 45, Train Loss: 1.2064, Val Loss: 1.2753, Test Loss: 1.2737, Val Acc: 0.5142, Test Acc: 0.5139
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6022.90 seconds
Epoch 46, Train Loss: 1.2020, Val Loss: 1.2667, Test Loss: 1.2676, Val Acc: 0.5167, Test Acc: 0.5149
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6154.16 seconds
Epoch 47, Train Loss: 1.2013, Val Loss: 1.2736, Test Loss: 1.2735, Val Acc: 0.5109, Test Acc: 0.5125

Time to best model: 6154.16 seconds
Epoch 48, Train Loss: 1.1992, Val Loss: 1.2777, Test Loss: 1.2776, Val Acc: 0.5139, Test Acc: 0.5114

Time to best model: 6154.16 seconds
Epoch 49, Train Loss: 1.1931, Val Loss: 1.2685, Test Loss: 1.2644, Val Acc: 0.5183, Test Acc: 0.5206
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6547.36 seconds
Epoch 50, Train Loss: 1.1927, Val Loss: 1.2670, Test Loss: 1.2635, Val Acc: 0.5191, Test Acc: 0.5205
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6678.48 seconds
Epoch 51, Train Loss: 1.1875, Val Loss: 1.2674, Test Loss: 1.2662, Val Acc: 0.5185, Test Acc: 0.5192

Time to best model: 6678.48 seconds
Epoch 52, Train Loss: 1.1852, Val Loss: 1.2732, Test Loss: 1.2723, Val Acc: 0.5201, Test Acc: 0.5172
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 6939.90 seconds
Epoch 53, Train Loss: 1.1839, Val Loss: 1.2683, Test Loss: 1.2677, Val Acc: 0.5208, Test Acc: 0.5209
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 7070.67 seconds
Epoch 54, Train Loss: 1.1806, Val Loss: 1.2857, Test Loss: 1.2845, Val Acc: 0.5190, Test Acc: 0.5185

Time to best model: 7070.67 seconds
Epoch 55, Train Loss: 1.1754, Val Loss: 1.2686, Test Loss: 1.2659, Val Acc: 0.5209, Test Acc: 0.5207
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 7333.42 seconds
Epoch 56, Train Loss: 1.1747, Val Loss: 1.2675, Test Loss: 1.2655, Val Acc: 0.5206, Test Acc: 0.5212

Time to best model: 7333.42 seconds
Epoch 57, Train Loss: 1.1695, Val Loss: 1.2861, Test Loss: 1.2899, Val Acc: 0.5170, Test Acc: 0.5156

Time to best model: 7333.42 seconds
Epoch 58, Train Loss: 1.1667, Val Loss: 1.2681, Test Loss: 1.2707, Val Acc: 0.5208, Test Acc: 0.5236

Time to best model: 7333.42 seconds
Epoch 59, Train Loss: 1.1652, Val Loss: 1.2694, Test Loss: 1.2673, Val Acc: 0.5214, Test Acc: 0.5216
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 7733.18 seconds
Epoch 60, Train Loss: 1.1615, Val Loss: 1.2717, Test Loss: 1.2711, Val Acc: 0.5195, Test Acc: 0.5200

Time to best model: 7733.18 seconds
Epoch 61, Train Loss: 1.1596, Val Loss: 1.2732, Test Loss: 1.2756, Val Acc: 0.5240, Test Acc: 0.5207
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 7877.59 seconds
Epoch 62, Train Loss: 1.1570, Val Loss: 1.2738, Test Loss: 1.2768, Val Acc: 0.5195, Test Acc: 0.5212

Time to best model: 7877.59 seconds
Epoch 63, Train Loss: 1.1517, Val Loss: 1.2726, Test Loss: 1.2724, Val Acc: 0.5223, Test Acc: 0.5208

Time to best model: 7877.59 seconds
Epoch 64, Train Loss: 1.1497, Val Loss: 1.2803, Test Loss: 1.2775, Val Acc: 0.5199, Test Acc: 0.5185

Time to best model: 7877.59 seconds
Epoch 65, Train Loss: 1.1489, Val Loss: 1.2796, Test Loss: 1.2759, Val Acc: 0.5235, Test Acc: 0.5232

Time to best model: 7877.59 seconds
Epoch 66, Train Loss: 1.1457, Val Loss: 1.2921, Test Loss: 1.2909, Val Acc: 0.5174, Test Acc: 0.5170

Time to best model: 7877.59 seconds
Epoch 67, Train Loss: 1.1420, Val Loss: 1.2882, Test Loss: 1.2882, Val Acc: 0.5170, Test Acc: 0.5172

Time to best model: 7877.59 seconds
Epoch 68, Train Loss: 1.1101, Val Loss: 1.2867, Test Loss: 1.2859, Val Acc: 0.5242, Test Acc: 0.5235
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 8235.35 seconds
Epoch 69, Train Loss: 1.1066, Val Loss: 1.2841, Test Loss: 1.2856, Val Acc: 0.5271, Test Acc: 0.5238
ðŸŒ¸ New best epoch! ðŸŒ¸

Time to best model: 8286.16 seconds
Epoch 70, Train Loss: 1.1027, Val Loss: 1.2965, Test Loss: 1.2996, Val Acc: 0.5233, Test Acc: 0.5221

Time to best model: 8286.16 seconds
Epoch 71, Train Loss: 1.0991, Val Loss: 1.3041, Test Loss: 1.3036, Val Acc: 0.5223, Test Acc: 0.5229

Time to best model: 8286.16 seconds
Epoch 72, Train Loss: 1.0960, Val Loss: 1.3078, Test Loss: 1.3062, Val Acc: 0.5225, Test Acc: 0.5201

Time to best model: 8286.16 seconds
Epoch 73, Train Loss: 1.0931, Val Loss: 1.3092, Test Loss: 1.3083, Val Acc: 0.5230, Test Acc: 0.5214

Time to best model: 8286.16 seconds
Epoch 74, Train Loss: 1.0911, Val Loss: 1.3121, Test Loss: 1.3117, Val Acc: 0.5213, Test Acc: 0.5219

Time to best model: 8286.16 seconds
Epoch 75, Train Loss: 1.0870, Val Loss: 1.3066, Test Loss: 1.3085, Val Acc: 0.5230, Test Acc: 0.5236

Time to best model: 8286.16 seconds
Epoch 76, Train Loss: 1.0704, Val Loss: 1.3109, Test Loss: 1.3104, Val Acc: 0.5257, Test Acc: 0.5261

Time to best model: 8286.16 seconds
Epoch 77, Train Loss: 1.0652, Val Loss: 1.3186, Test Loss: 1.3180, Val Acc: 0.5249, Test Acc: 0.5235

Time to best model: 8286.16 seconds
Epoch 78, Train Loss: 1.0626, Val Loss: 1.3191, Test Loss: 1.3193, Val Acc: 0.5251, Test Acc: 0.5264

Time to best model: 8286.16 seconds
Epoch 79, Train Loss: 1.0608, Val Loss: 1.3277, Test Loss: 1.3252, Val Acc: 0.5235, Test Acc: 0.5253

Time to best model: 8286.16 seconds
Epoch 80, Train Loss: 1.0594, Val Loss: 1.3126, Test Loss: 1.3106, Val Acc: 0.5264, Test Acc: 0.5267

Time to best model: 8286.16 seconds
Epoch 81, Train Loss: 1.0585, Val Loss: 1.3349, Test Loss: 1.3347, Val Acc: 0.5248, Test Acc: 0.5246

Time to best model: 8286.16 seconds
Epoch 82, Train Loss: 1.0487, Val Loss: 1.3319, Test Loss: 1.3317, Val Acc: 0.5242, Test Acc: 0.5258

Time to best model: 8286.16 seconds
Epoch 83, Train Loss: 1.0451, Val Loss: 1.3267, Test Loss: 1.3262, Val Acc: 0.5264, Test Acc: 0.5265

Time to best model: 8286.16 seconds
Epoch 84, Train Loss: 1.0445, Val Loss: 1.3336, Test Loss: 1.3337, Val Acc: 0.5249, Test Acc: 0.5275

Time to best model: 8286.16 seconds
Epoch 85, Train Loss: 1.0429, Val Loss: 1.3311, Test Loss: 1.3297, Val Acc: 0.5242, Test Acc: 0.5270
Test score after training: 0.5270
Throughput after training: 10708.40 samples/second
Latency after training: 0.09 ms/sample

Result:
{'val': 0.5271136363636364, 'test': 0.5237954545454545, 'epoch': 69}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0945
SNR = -18: Acc =  0.0964
SNR = -16: Acc =  0.0955
SNR = -14: Acc =  0.1132
SNR = -12: Acc =  0.1500
SNR = -10: Acc =  0.2227
SNR =  -8: Acc =  0.3159
SNR =  -6: Acc =  0.4482
SNR =  -4: Acc =  0.5750
SNR =  -2: Acc =  0.6905
SNR =   0: Acc =  0.7386
SNR =   2: Acc =  0.7605
SNR =   4: Acc =  0.7709
SNR =   6: Acc =  0.7800
SNR =   8: Acc =  0.7695
SNR =  10: Acc =  0.7795
SNR =  12: Acc =  0.7859
SNR =  14: Acc =  0.7959
SNR =  16: Acc =  0.7745
SNR =  18: Acc =  0.7827
==========================

