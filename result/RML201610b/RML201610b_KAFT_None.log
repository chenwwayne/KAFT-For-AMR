Using device: cuda

========================================
Running with parameters:
             dataset: RML201610b
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201610b/RML201610b_KAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: [b'8PSK', b'AM-DSB', b'BPSK', b'CPFSK', b'GFSK', b'PAM4', b'QAM16', b'QAM64', b'QPSK', b'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 1200000
Padding: (960000, 128, 2)
Padding: (240000, 128, 2)
Padding: (240000, 128, 2)

Final data shapes:
X_train: (960000, 128, 2), Y_train: (960000, 10)
X_val: (240000, 128, 2), Y_val: (240000, 10)
X_test: (240000, 128, 2), Y_test: (240000, 10)
After reshaping and sampling:
X_train: (960000, 256) (sampled from original)
X_val:   (240000, 256) (sampled from original)
X_test:  (240000, 256) (sampled from original)
Y_train: (960000, 10)
{'d_out': 10, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.386K
FLOPs per sample: 209.492M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.6429, Val Loss: 1.3255, Test Loss: 1.3255, Val Acc: 0.4588, Test Acc: 0.4588
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.3017, Val Loss: 1.2458, Test Loss: 1.2458, Val Acc: 0.4914, Test Acc: 0.4914
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.2448, Val Loss: 1.2170, Test Loss: 1.2170, Val Acc: 0.5009, Test Acc: 0.5009
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.1968, Val Loss: 1.1623, Test Loss: 1.1623, Val Acc: 0.5202, Test Acc: 0.5202
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.1594, Val Loss: 1.1257, Test Loss: 1.1257, Val Acc: 0.5346, Test Acc: 0.5346
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.1352, Val Loss: 1.1146, Test Loss: 1.1146, Val Acc: 0.5389, Test Acc: 0.5389
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.1152, Val Loss: 1.0937, Test Loss: 1.0937, Val Acc: 0.5465, Test Acc: 0.5465
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.0985, Val Loss: 1.0821, Test Loss: 1.0821, Val Acc: 0.5505, Test Acc: 0.5505
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.0828, Val Loss: 1.0709, Test Loss: 1.0709, Val Acc: 0.5548, Test Acc: 0.5548
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.0706, Val Loss: 1.0616, Test Loss: 1.0616, Val Acc: 0.5580, Test Acc: 0.5580
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 1.0594, Val Loss: 1.0422, Test Loss: 1.0422, Val Acc: 0.5684, Test Acc: 0.5684
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.0504, Val Loss: 1.0371, Test Loss: 1.0371, Val Acc: 0.5696, Test Acc: 0.5696
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 1.0434, Val Loss: 1.0476, Test Loss: 1.0476, Val Acc: 0.5675, Test Acc: 0.5675

Epoch 13, Train Loss: 1.0361, Val Loss: 1.0287, Test Loss: 1.0287, Val Acc: 0.5753, Test Acc: 0.5753
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 1.0292, Val Loss: 1.0165, Test Loss: 1.0165, Val Acc: 0.5786, Test Acc: 0.5786
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 1.0228, Val Loss: 1.0096, Test Loss: 1.0096, Val Acc: 0.5831, Test Acc: 0.5831
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.0164, Val Loss: 1.0076, Test Loss: 1.0076, Val Acc: 0.5847, Test Acc: 0.5847
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 1.0111, Val Loss: 1.0090, Test Loss: 1.0090, Val Acc: 0.5867, Test Acc: 0.5867
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 18, Train Loss: 1.0045, Val Loss: 1.0004, Test Loss: 1.0004, Val Acc: 0.5932, Test Acc: 0.5932
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 19, Train Loss: 0.9973, Val Loss: 0.9865, Test Loss: 0.9865, Val Acc: 0.5970, Test Acc: 0.5970
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 20, Train Loss: 0.9901, Val Loss: 0.9816, Test Loss: 0.9816, Val Acc: 0.5999, Test Acc: 0.5999
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 21, Train Loss: 0.9852, Val Loss: 0.9801, Test Loss: 0.9801, Val Acc: 0.6019, Test Acc: 0.6019
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 22, Train Loss: 0.9803, Val Loss: 0.9785, Test Loss: 0.9785, Val Acc: 0.6026, Test Acc: 0.6026
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 23, Train Loss: 0.9774, Val Loss: 0.9767, Test Loss: 0.9767, Val Acc: 0.6050, Test Acc: 0.6050
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 24, Train Loss: 0.9732, Val Loss: 0.9672, Test Loss: 0.9672, Val Acc: 0.6078, Test Acc: 0.6078
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 25, Train Loss: 0.9693, Val Loss: 0.9672, Test Loss: 0.9672, Val Acc: 0.6102, Test Acc: 0.6102
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 26, Train Loss: 0.9658, Val Loss: 0.9662, Test Loss: 0.9662, Val Acc: 0.6098, Test Acc: 0.6098

Epoch 27, Train Loss: 0.9628, Val Loss: 0.9610, Test Loss: 0.9610, Val Acc: 0.6113, Test Acc: 0.6113
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 28, Train Loss: 0.9592, Val Loss: 0.9591, Test Loss: 0.9591, Val Acc: 0.6121, Test Acc: 0.6121
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 29, Train Loss: 0.9560, Val Loss: 0.9499, Test Loss: 0.9499, Val Acc: 0.6169, Test Acc: 0.6169
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 30, Train Loss: 0.9516, Val Loss: 0.9503, Test Loss: 0.9503, Val Acc: 0.6181, Test Acc: 0.6181
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 31, Train Loss: 0.9468, Val Loss: 0.9494, Test Loss: 0.9494, Val Acc: 0.6189, Test Acc: 0.6189
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 32, Train Loss: 0.9404, Val Loss: 0.9442, Test Loss: 0.9442, Val Acc: 0.6194, Test Acc: 0.6194
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 33, Train Loss: 0.9343, Val Loss: 0.9347, Test Loss: 0.9347, Val Acc: 0.6237, Test Acc: 0.6237
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 34, Train Loss: 0.9292, Val Loss: 0.9272, Test Loss: 0.9272, Val Acc: 0.6271, Test Acc: 0.6271
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 35, Train Loss: 0.9258, Val Loss: 0.9172, Test Loss: 0.9172, Val Acc: 0.6311, Test Acc: 0.6311
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 36, Train Loss: 0.9224, Val Loss: 0.9250, Test Loss: 0.9250, Val Acc: 0.6286, Test Acc: 0.6286

Epoch 37, Train Loss: 0.9190, Val Loss: 0.9164, Test Loss: 0.9164, Val Acc: 0.6310, Test Acc: 0.6310

Epoch 38, Train Loss: 0.9156, Val Loss: 0.9144, Test Loss: 0.9144, Val Acc: 0.6326, Test Acc: 0.6326
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 39, Train Loss: 0.9118, Val Loss: 0.9121, Test Loss: 0.9121, Val Acc: 0.6331, Test Acc: 0.6331
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 40, Train Loss: 0.9095, Val Loss: 0.9066, Test Loss: 0.9066, Val Acc: 0.6351, Test Acc: 0.6351
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 41, Train Loss: 0.9063, Val Loss: 0.9011, Test Loss: 0.9011, Val Acc: 0.6372, Test Acc: 0.6372
ðŸŒ¸ New best epoch! ðŸŒ¸

