Using device: cuda

========================================
Running with parameters:
             dataset: RML201610b
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201610b/RML201610b_MKAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: [b'8PSK', b'AM-DSB', b'BPSK', b'CPFSK', b'GFSK', b'PAM4', b'QAM16', b'QAM64', b'QPSK', b'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 1200000
Padding: (960000, 128, 2)
Padding: (240000, 128, 2)
Padding: (240000, 128, 2)

Final data shapes:
X_train: (960000, 128, 2), Y_train: (960000, 10)
X_val: (240000, 128, 2), Y_val: (240000, 10)
X_test: (240000, 128, 2), Y_test: (240000, 10)
After reshaping and sampling:
X_train: (960000, 256) (sampled from original)
X_val:   (240000, 256) (sampled from original)
X_test:  (240000, 256) (sampled from original)
Y_train: (960000, 10)
{'d_out': 10, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.386K
FLOPs per sample: 209.492M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.4984, Val Loss: 1.2878, Test Loss: 1.2878, Val Acc: 0.4803, Test Acc: 0.4803
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.2675, Val Loss: 1.2264, Test Loss: 1.2264, Val Acc: 0.5072, Test Acc: 0.5072
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.1941, Val Loss: 1.1160, Test Loss: 1.1160, Val Acc: 0.5506, Test Acc: 0.5506
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.1124, Val Loss: 1.0896, Test Loss: 1.0896, Val Acc: 0.5604, Test Acc: 0.5604
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.0850, Val Loss: 1.0683, Test Loss: 1.0683, Val Acc: 0.5699, Test Acc: 0.5699
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.0612, Val Loss: 1.0381, Test Loss: 1.0381, Val Acc: 0.5796, Test Acc: 0.5796
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.0339, Val Loss: 1.0386, Test Loss: 1.0386, Val Acc: 0.5816, Test Acc: 0.5816
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.0067, Val Loss: 0.9883, Test Loss: 0.9883, Val Acc: 0.6002, Test Acc: 0.6002
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 0.9912, Val Loss: 0.9784, Test Loss: 0.9784, Val Acc: 0.6066, Test Acc: 0.6066
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 0.9823, Val Loss: 0.9759, Test Loss: 0.9759, Val Acc: 0.6054, Test Acc: 0.6054

Epoch 10, Train Loss: 0.9747, Val Loss: 0.9684, Test Loss: 0.9684, Val Acc: 0.6086, Test Acc: 0.6086
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 0.9686, Val Loss: 0.9609, Test Loss: 0.9609, Val Acc: 0.6131, Test Acc: 0.6131
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 0.9633, Val Loss: 0.9565, Test Loss: 0.9565, Val Acc: 0.6138, Test Acc: 0.6138
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 0.9597, Val Loss: 0.9554, Test Loss: 0.9554, Val Acc: 0.6151, Test Acc: 0.6151
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 0.9562, Val Loss: 0.9498, Test Loss: 0.9498, Val Acc: 0.6171, Test Acc: 0.6171
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 0.9527, Val Loss: 0.9563, Test Loss: 0.9563, Val Acc: 0.6152, Test Acc: 0.6152

Epoch 16, Train Loss: 0.9502, Val Loss: 0.9485, Test Loss: 0.9485, Val Acc: 0.6183, Test Acc: 0.6183
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 0.9473, Val Loss: 0.9559, Test Loss: 0.9559, Val Acc: 0.6164, Test Acc: 0.6164

Epoch 18, Train Loss: 0.9447, Val Loss: 0.9457, Test Loss: 0.9457, Val Acc: 0.6190, Test Acc: 0.6190
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 19, Train Loss: 0.9428, Val Loss: 0.9468, Test Loss: 0.9468, Val Acc: 0.6185, Test Acc: 0.6185

Epoch 20, Train Loss: 0.9409, Val Loss: 0.9435, Test Loss: 0.9435, Val Acc: 0.6213, Test Acc: 0.6213
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 21, Train Loss: 0.9390, Val Loss: 0.9498, Test Loss: 0.9498, Val Acc: 0.6192, Test Acc: 0.6192

Epoch 22, Train Loss: 0.9373, Val Loss: 0.9446, Test Loss: 0.9446, Val Acc: 0.6209, Test Acc: 0.6209

Epoch 23, Train Loss: 0.9359, Val Loss: 0.9391, Test Loss: 0.9391, Val Acc: 0.6217, Test Acc: 0.6217
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 24, Train Loss: 0.9336, Val Loss: 0.9398, Test Loss: 0.9398, Val Acc: 0.6212, Test Acc: 0.6212

Epoch 25, Train Loss: 0.9322, Val Loss: 0.9395, Test Loss: 0.9395, Val Acc: 0.6220, Test Acc: 0.6220
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 26, Train Loss: 0.9305, Val Loss: 0.9396, Test Loss: 0.9396, Val Acc: 0.6226, Test Acc: 0.6226
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 27, Train Loss: 0.9287, Val Loss: 0.9379, Test Loss: 0.9379, Val Acc: 0.6227, Test Acc: 0.6227
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 28, Train Loss: 0.9262, Val Loss: 0.9355, Test Loss: 0.9355, Val Acc: 0.6244, Test Acc: 0.6244
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 29, Train Loss: 0.9244, Val Loss: 0.9308, Test Loss: 0.9308, Val Acc: 0.6250, Test Acc: 0.6250
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 30, Train Loss: 0.9223, Val Loss: 0.9331, Test Loss: 0.9331, Val Acc: 0.6252, Test Acc: 0.6252
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 31, Train Loss: 0.9204, Val Loss: 0.9252, Test Loss: 0.9252, Val Acc: 0.6269, Test Acc: 0.6269
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 32, Train Loss: 0.9189, Val Loss: 0.9284, Test Loss: 0.9284, Val Acc: 0.6258, Test Acc: 0.6258

Epoch 33, Train Loss: 0.9170, Val Loss: 0.9263, Test Loss: 0.9263, Val Acc: 0.6266, Test Acc: 0.6266

Epoch 34, Train Loss: 0.9161, Val Loss: 0.9262, Test Loss: 0.9262, Val Acc: 0.6278, Test Acc: 0.6278
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 35, Train Loss: 0.9142, Val Loss: 0.9243, Test Loss: 0.9243, Val Acc: 0.6275, Test Acc: 0.6275

Epoch 36, Train Loss: 0.9132, Val Loss: 0.9250, Test Loss: 0.9250, Val Acc: 0.6281, Test Acc: 0.6281
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 37, Train Loss: 0.9113, Val Loss: 0.9260, Test Loss: 0.9260, Val Acc: 0.6272, Test Acc: 0.6272

Epoch 38, Train Loss: 0.9107, Val Loss: 0.9190, Test Loss: 0.9190, Val Acc: 0.6301, Test Acc: 0.6301
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 39, Train Loss: 0.9088, Val Loss: 0.9229, Test Loss: 0.9229, Val Acc: 0.6286, Test Acc: 0.6286

Epoch 40, Train Loss: 0.9076, Val Loss: 0.9287, Test Loss: 0.9287, Val Acc: 0.6279, Test Acc: 0.6279

Epoch 41, Train Loss: 0.9071, Val Loss: 0.9198, Test Loss: 0.9198, Val Acc: 0.6298, Test Acc: 0.6298

Epoch 42, Train Loss: 0.9054, Val Loss: 0.9213, Test Loss: 0.9213, Val Acc: 0.6297, Test Acc: 0.6297

Epoch 43, Train Loss: 0.9045, Val Loss: 0.9242, Test Loss: 0.9242, Val Acc: 0.6285, Test Acc: 0.6285

Epoch 44, Train Loss: 0.9035, Val Loss: 0.9194, Test Loss: 0.9194, Val Acc: 0.6291, Test Acc: 0.6291

Epoch 45, Train Loss: 0.8836, Val Loss: 0.9104, Test Loss: 0.9104, Val Acc: 0.6341, Test Acc: 0.6341
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 46, Train Loss: 0.8795, Val Loss: 0.9108, Test Loss: 0.9108, Val Acc: 0.6352, Test Acc: 0.6352
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 47, Train Loss: 0.8772, Val Loss: 0.9098, Test Loss: 0.9098, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 48, Train Loss: 0.8754, Val Loss: 0.9124, Test Loss: 0.9124, Val Acc: 0.6345, Test Acc: 0.6345

Epoch 49, Train Loss: 0.8741, Val Loss: 0.9112, Test Loss: 0.9112, Val Acc: 0.6353, Test Acc: 0.6353
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 50, Train Loss: 0.8726, Val Loss: 0.9135, Test Loss: 0.9135, Val Acc: 0.6341, Test Acc: 0.6341

Epoch 51, Train Loss: 0.8709, Val Loss: 0.9159, Test Loss: 0.9159, Val Acc: 0.6343, Test Acc: 0.6343

Epoch 52, Train Loss: 0.8702, Val Loss: 0.9163, Test Loss: 0.9163, Val Acc: 0.6330, Test Acc: 0.6330

Epoch 53, Train Loss: 0.8691, Val Loss: 0.9173, Test Loss: 0.9173, Val Acc: 0.6343, Test Acc: 0.6343

Epoch 54, Train Loss: 0.8676, Val Loss: 0.9169, Test Loss: 0.9169, Val Acc: 0.6354, Test Acc: 0.6354
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 55, Train Loss: 0.8667, Val Loss: 0.9169, Test Loss: 0.9169, Val Acc: 0.6332, Test Acc: 0.6332

Epoch 56, Train Loss: 0.8658, Val Loss: 0.9197, Test Loss: 0.9197, Val Acc: 0.6335, Test Acc: 0.6335

Epoch 57, Train Loss: 0.8646, Val Loss: 0.9195, Test Loss: 0.9195, Val Acc: 0.6337, Test Acc: 0.6337

Epoch 58, Train Loss: 0.8636, Val Loss: 0.9247, Test Loss: 0.9247, Val Acc: 0.6330, Test Acc: 0.6330

Epoch 59, Train Loss: 0.8628, Val Loss: 0.9202, Test Loss: 0.9202, Val Acc: 0.6341, Test Acc: 0.6341

Epoch 60, Train Loss: 0.8616, Val Loss: 0.9234, Test Loss: 0.9234, Val Acc: 0.6335, Test Acc: 0.6335

Epoch 61, Train Loss: 0.8486, Val Loss: 0.9195, Test Loss: 0.9195, Val Acc: 0.6356, Test Acc: 0.6356
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 62, Train Loss: 0.8452, Val Loss: 0.9208, Test Loss: 0.9208, Val Acc: 0.6359, Test Acc: 0.6359
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 63, Train Loss: 0.8437, Val Loss: 0.9252, Test Loss: 0.9252, Val Acc: 0.6353, Test Acc: 0.6353

Epoch 64, Train Loss: 0.8420, Val Loss: 0.9277, Test Loss: 0.9277, Val Acc: 0.6343, Test Acc: 0.6343

Epoch 65, Train Loss: 0.8413, Val Loss: 0.9283, Test Loss: 0.9283, Val Acc: 0.6355, Test Acc: 0.6355

Epoch 66, Train Loss: 0.8405, Val Loss: 0.9268, Test Loss: 0.9268, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 67, Train Loss: 0.8391, Val Loss: 0.9267, Test Loss: 0.9267, Val Acc: 0.6351, Test Acc: 0.6351

Epoch 68, Train Loss: 0.8384, Val Loss: 0.9279, Test Loss: 0.9279, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 69, Train Loss: 0.8309, Val Loss: 0.9306, Test Loss: 0.9306, Val Acc: 0.6350, Test Acc: 0.6350

Epoch 70, Train Loss: 0.8281, Val Loss: 0.9369, Test Loss: 0.9369, Val Acc: 0.6351, Test Acc: 0.6351

Epoch 71, Train Loss: 0.8274, Val Loss: 0.9342, Test Loss: 0.9342, Val Acc: 0.6351, Test Acc: 0.6351

Epoch 72, Train Loss: 0.8268, Val Loss: 0.9398, Test Loss: 0.9398, Val Acc: 0.6347, Test Acc: 0.6347

Epoch 73, Train Loss: 0.8259, Val Loss: 0.9370, Test Loss: 0.9370, Val Acc: 0.6346, Test Acc: 0.6346

Epoch 74, Train Loss: 0.8250, Val Loss: 0.9400, Test Loss: 0.9400, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 75, Train Loss: 0.8211, Val Loss: 0.9390, Test Loss: 0.9390, Val Acc: 0.6351, Test Acc: 0.6351

Epoch 76, Train Loss: 0.8198, Val Loss: 0.9410, Test Loss: 0.9410, Val Acc: 0.6353, Test Acc: 0.6353

Epoch 77, Train Loss: 0.8194, Val Loss: 0.9423, Test Loss: 0.9423, Val Acc: 0.6352, Test Acc: 0.6352

Epoch 78, Train Loss: 0.8191, Val Loss: 0.9430, Test Loss: 0.9430, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 79, Train Loss: 0.8184, Val Loss: 0.9446, Test Loss: 0.9446, Val Acc: 0.6351, Test Acc: 0.6351

Epoch 80, Train Loss: 0.8179, Val Loss: 0.9430, Test Loss: 0.9430, Val Acc: 0.6346, Test Acc: 0.6346

Epoch 81, Train Loss: 0.8159, Val Loss: 0.9449, Test Loss: 0.9449, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 82, Train Loss: 0.8156, Val Loss: 0.9459, Test Loss: 0.9459, Val Acc: 0.6345, Test Acc: 0.6345

Epoch 83, Train Loss: 0.8147, Val Loss: 0.9482, Test Loss: 0.9482, Val Acc: 0.6350, Test Acc: 0.6350

Epoch 84, Train Loss: 0.8149, Val Loss: 0.9474, Test Loss: 0.9474, Val Acc: 0.6345, Test Acc: 0.6345

Epoch 85, Train Loss: 0.8143, Val Loss: 0.9492, Test Loss: 0.9492, Val Acc: 0.6346, Test Acc: 0.6346

Epoch 86, Train Loss: 0.8139, Val Loss: 0.9485, Test Loss: 0.9485, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 87, Train Loss: 0.8131, Val Loss: 0.9504, Test Loss: 0.9504, Val Acc: 0.6350, Test Acc: 0.6350

Epoch 88, Train Loss: 0.8124, Val Loss: 0.9489, Test Loss: 0.9489, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 89, Train Loss: 0.8123, Val Loss: 0.9498, Test Loss: 0.9498, Val Acc: 0.6352, Test Acc: 0.6352

Epoch 90, Train Loss: 0.8125, Val Loss: 0.9524, Test Loss: 0.9524, Val Acc: 0.6347, Test Acc: 0.6347

Epoch 91, Train Loss: 0.8124, Val Loss: 0.9489, Test Loss: 0.9489, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 92, Train Loss: 0.8120, Val Loss: 0.9517, Test Loss: 0.9517, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 93, Train Loss: 0.8118, Val Loss: 0.9514, Test Loss: 0.9514, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 94, Train Loss: 0.8115, Val Loss: 0.9506, Test Loss: 0.9506, Val Acc: 0.6346, Test Acc: 0.6346

Epoch 95, Train Loss: 0.8114, Val Loss: 0.9524, Test Loss: 0.9524, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 96, Train Loss: 0.8110, Val Loss: 0.9519, Test Loss: 0.9519, Val Acc: 0.6347, Test Acc: 0.6347

Epoch 97, Train Loss: 0.8111, Val Loss: 0.9520, Test Loss: 0.9520, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 98, Train Loss: 0.8109, Val Loss: 0.9524, Test Loss: 0.9524, Val Acc: 0.6347, Test Acc: 0.6347

Epoch 99, Train Loss: 0.8105, Val Loss: 0.9522, Test Loss: 0.9522, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 100, Train Loss: 0.8103, Val Loss: 0.9532, Test Loss: 0.9532, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 101, Train Loss: 0.8107, Val Loss: 0.9525, Test Loss: 0.9525, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 102, Train Loss: 0.8103, Val Loss: 0.9528, Test Loss: 0.9528, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 103, Train Loss: 0.8106, Val Loss: 0.9527, Test Loss: 0.9527, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 104, Train Loss: 0.8103, Val Loss: 0.9533, Test Loss: 0.9533, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 105, Train Loss: 0.8103, Val Loss: 0.9527, Test Loss: 0.9527, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 106, Train Loss: 0.8108, Val Loss: 0.9527, Test Loss: 0.9527, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 107, Train Loss: 0.8105, Val Loss: 0.9526, Test Loss: 0.9526, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 108, Train Loss: 0.8104, Val Loss: 0.9525, Test Loss: 0.9525, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 109, Train Loss: 0.8101, Val Loss: 0.9528, Test Loss: 0.9528, Val Acc: 0.6349, Test Acc: 0.6349

Epoch 110, Train Loss: 0.8106, Val Loss: 0.9526, Test Loss: 0.9526, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 111, Train Loss: 0.8103, Val Loss: 0.9527, Test Loss: 0.9527, Val Acc: 0.6348, Test Acc: 0.6348

Epoch 112, Train Loss: 0.8103, Val Loss: 0.9529, Test Loss: 0.9529, Val Acc: 0.6348, Test Acc: 0.6348
Time to best model: 23257.09 seconds
Loaded best model from result/RML201610b/RML201610b_MKAFT_BEST.pth for evaluation.
Test score after training: 0.6359
Throughput after training: 15253.67 samples/second
Latency after training: 0.07 ms/sample

Result:
{'val': 0.6358666666666667, 'test': 0.6358666666666667, 'epoch': 62}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.1064
SNR = -18: Acc =  0.1155
SNR = -16: Acc =  0.1271
SNR = -14: Acc =  0.1618
SNR = -12: Acc =  0.2018
SNR = -10: Acc =  0.2972
SNR =  -8: Acc =  0.3952
SNR =  -6: Acc =  0.5124
SNR =  -4: Acc =  0.6811
SNR =  -2: Acc =  0.8304
SNR =   0: Acc =  0.9008
SNR =   2: Acc =  0.9206
SNR =   4: Acc =  0.9289
SNR =   6: Acc =  0.9323
SNR =   8: Acc =  0.9329
SNR =  10: Acc =  0.9337
SNR =  12: Acc =  0.9365
SNR =  14: Acc =  0.9331
SNR =  16: Acc =  0.9340
SNR =  18: Acc =  0.9355
==========================

