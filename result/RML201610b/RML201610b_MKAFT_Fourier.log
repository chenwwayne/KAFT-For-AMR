Using device: cuda

========================================
Running with parameters:
             dataset: RML201610b
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201610b/RML201610b_MKAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: [b'8PSK', b'AM-DSB', b'BPSK', b'CPFSK', b'GFSK', b'PAM4', b'QAM16', b'QAM64', b'QPSK', b'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 1200000
Padding: (960000, 128, 2)
Padding: (240000, 128, 2)
Padding: (240000, 128, 2)

Final data shapes:
X_train: (960000, 128, 2), Y_train: (960000, 10)
X_val: (240000, 128, 2), Y_val: (240000, 10)
X_test: (240000, 128, 2), Y_test: (240000, 10)
After reshaping and sampling:
X_train: (960000, 256) (sampled from original)
X_val:   (240000, 256) (sampled from original)
X_test:  (240000, 256) (sampled from original)
Y_train: (960000, 10)
{'d_out': 10, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.386K
FLOPs per sample: 209.492M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.4791, Val Loss: 1.3422, Test Loss: 1.3422, Val Acc: 0.4612, Test Acc: 0.4612
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.2553, Val Loss: 1.1968, Test Loss: 1.1968, Val Acc: 0.5144, Test Acc: 0.5144
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.1543, Val Loss: 1.1282, Test Loss: 1.1282, Val Acc: 0.5460, Test Acc: 0.5460
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.1144, Val Loss: 1.0889, Test Loss: 1.0889, Val Acc: 0.5616, Test Acc: 0.5616
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.0812, Val Loss: 1.0620, Test Loss: 1.0620, Val Acc: 0.5699, Test Acc: 0.5699
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.0442, Val Loss: 1.0149, Test Loss: 1.0149, Val Acc: 0.5892, Test Acc: 0.5892
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.0114, Val Loss: 1.0052, Test Loss: 1.0052, Val Acc: 0.5938, Test Acc: 0.5938
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 0.9960, Val Loss: 0.9838, Test Loss: 0.9838, Val Acc: 0.6030, Test Acc: 0.6030
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 0.9862, Val Loss: 0.9773, Test Loss: 0.9773, Val Acc: 0.6063, Test Acc: 0.6063
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 0.9779, Val Loss: 0.9713, Test Loss: 0.9713, Val Acc: 0.6088, Test Acc: 0.6088
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 0.9713, Val Loss: 0.9663, Test Loss: 0.9663, Val Acc: 0.6098, Test Acc: 0.6098
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 0.9658, Val Loss: 0.9690, Test Loss: 0.9690, Val Acc: 0.6093, Test Acc: 0.6093

Epoch 12, Train Loss: 0.9614, Val Loss: 0.9625, Test Loss: 0.9625, Val Acc: 0.6116, Test Acc: 0.6116
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 0.9569, Val Loss: 0.9621, Test Loss: 0.9621, Val Acc: 0.6134, Test Acc: 0.6134
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 0.9530, Val Loss: 0.9567, Test Loss: 0.9567, Val Acc: 0.6144, Test Acc: 0.6144
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 0.9493, Val Loss: 0.9571, Test Loss: 0.9571, Val Acc: 0.6151, Test Acc: 0.6151
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 0.9457, Val Loss: 0.9478, Test Loss: 0.9478, Val Acc: 0.6178, Test Acc: 0.6178
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 0.9424, Val Loss: 0.9495, Test Loss: 0.9495, Val Acc: 0.6185, Test Acc: 0.6185
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 18, Train Loss: 0.9393, Val Loss: 0.9418, Test Loss: 0.9418, Val Acc: 0.6205, Test Acc: 0.6205
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 19, Train Loss: 0.9362, Val Loss: 0.9424, Test Loss: 0.9424, Val Acc: 0.6210, Test Acc: 0.6210
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 20, Train Loss: 0.9330, Val Loss: 0.9447, Test Loss: 0.9447, Val Acc: 0.6196, Test Acc: 0.6196

Epoch 21, Train Loss: 0.9304, Val Loss: 0.9370, Test Loss: 0.9370, Val Acc: 0.6244, Test Acc: 0.6244
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 22, Train Loss: 0.9280, Val Loss: 0.9408, Test Loss: 0.9408, Val Acc: 0.6222, Test Acc: 0.6222

Epoch 23, Train Loss: 0.9248, Val Loss: 0.9428, Test Loss: 0.9428, Val Acc: 0.6239, Test Acc: 0.6239

Epoch 24, Train Loss: 0.9227, Val Loss: 0.9325, Test Loss: 0.9325, Val Acc: 0.6252, Test Acc: 0.6252
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 25, Train Loss: 0.9208, Val Loss: 0.9306, Test Loss: 0.9306, Val Acc: 0.6256, Test Acc: 0.6256
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 26, Train Loss: 0.9181, Val Loss: 0.9281, Test Loss: 0.9281, Val Acc: 0.6269, Test Acc: 0.6269
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 27, Train Loss: 0.9155, Val Loss: 0.9239, Test Loss: 0.9239, Val Acc: 0.6280, Test Acc: 0.6280
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 28, Train Loss: 0.9141, Val Loss: 0.9247, Test Loss: 0.9247, Val Acc: 0.6278, Test Acc: 0.6278

Epoch 29, Train Loss: 0.9124, Val Loss: 0.9221, Test Loss: 0.9221, Val Acc: 0.6289, Test Acc: 0.6289
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 30, Train Loss: 0.9104, Val Loss: 0.9257, Test Loss: 0.9257, Val Acc: 0.6286, Test Acc: 0.6286

Epoch 31, Train Loss: 0.9086, Val Loss: 0.9276, Test Loss: 0.9276, Val Acc: 0.6304, Test Acc: 0.6304
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 32, Train Loss: 0.9071, Val Loss: 0.9193, Test Loss: 0.9193, Val Acc: 0.6305, Test Acc: 0.6305
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 33, Train Loss: 0.9058, Val Loss: 0.9198, Test Loss: 0.9198, Val Acc: 0.6301, Test Acc: 0.6301

Epoch 34, Train Loss: 0.9039, Val Loss: 0.9228, Test Loss: 0.9228, Val Acc: 0.6306, Test Acc: 0.6306
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 35, Train Loss: 0.9031, Val Loss: 0.9223, Test Loss: 0.9223, Val Acc: 0.6309, Test Acc: 0.6309
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 36, Train Loss: 0.9013, Val Loss: 0.9206, Test Loss: 0.9206, Val Acc: 0.6296, Test Acc: 0.6296

