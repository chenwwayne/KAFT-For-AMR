Using device: cuda

========================================
Running with parameters:
             dataset: RML201610b
           data_path: ./dataset
            n_epochs: 1000000000
            patience: 50
          batch_size: 400
  accumulation_steps: 1
          data_ratio: 1.0
                  lr: 0.001
         lr_patience: 5
           lr_factor: 0.5
              device: cuda
                 gpu: 0
     best_model_path: result/RML201610b/RML201610b_MKAFT_BEST.pth
========================================

Using GPU(s): 0
Using device: cuda
Modulations: [b'8PSK', b'AM-DSB', b'BPSK', b'CPFSK', b'GFSK', b'PAM4', b'QAM16', b'QAM64', b'QPSK', b'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 1200000
Padding: (720000, 128, 2)
Padding: (240000, 128, 2)
Padding: (240000, 128, 2)

Final data shapes:
X_train: (720000, 128, 2), Y_train: (720000, 10)
X_val: (240000, 128, 2), Y_val: (240000, 10)
X_test: (240000, 128, 2), Y_test: (240000, 10)
After reshaping and sampling:
X_train: (720000, 256) (sampled from original)
X_val:   (240000, 256) (sampled from original)
X_test:  (240000, 256) (sampled from original)
Y_train: (720000, 10)
{'d_out': 10, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.386K
FLOPs per sample: 209.492M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.7657, Val Loss: 1.4589, Test Loss: 1.4574, Val Acc: 0.4071, Test Acc: 0.4060
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.3277, Val Loss: 1.2625, Test Loss: 1.2632, Val Acc: 0.4807, Test Acc: 0.4800
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.2359, Val Loss: 1.1992, Test Loss: 1.2000, Val Acc: 0.5057, Test Acc: 0.5052
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.1889, Val Loss: 1.1642, Test Loss: 1.1650, Val Acc: 0.5243, Test Acc: 0.5230
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.1524, Val Loss: 1.1364, Test Loss: 1.1363, Val Acc: 0.5348, Test Acc: 0.5344
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.1159, Val Loss: 1.0886, Test Loss: 1.0891, Val Acc: 0.5512, Test Acc: 0.5511
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.0845, Val Loss: 1.0589, Test Loss: 1.0589, Val Acc: 0.5673, Test Acc: 0.5669
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.0621, Val Loss: 1.0412, Test Loss: 1.0409, Val Acc: 0.5760, Test Acc: 0.5756
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.0474, Val Loss: 1.0357, Test Loss: 1.0371, Val Acc: 0.5774, Test Acc: 0.5768
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.0357, Val Loss: 1.0172, Test Loss: 1.0176, Val Acc: 0.5799, Test Acc: 0.5806
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 1.0283, Val Loss: 1.0177, Test Loss: 1.0167, Val Acc: 0.5848, Test Acc: 0.5849
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.0210, Val Loss: 1.0056, Test Loss: 1.0060, Val Acc: 0.5902, Test Acc: 0.5907
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 1.0154, Val Loss: 1.0052, Test Loss: 1.0052, Val Acc: 0.5894, Test Acc: 0.5898

Epoch 13, Train Loss: 1.0105, Val Loss: 0.9927, Test Loss: 0.9932, Val Acc: 0.5954, Test Acc: 0.5959
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 1.0072, Val Loss: 1.0005, Test Loss: 1.0011, Val Acc: 0.5924, Test Acc: 0.5928

Epoch 15, Train Loss: 1.0024, Val Loss: 1.0044, Test Loss: 1.0047, Val Acc: 0.5926, Test Acc: 0.5932

Epoch 16, Train Loss: 0.9993, Val Loss: 0.9903, Test Loss: 0.9909, Val Acc: 0.5967, Test Acc: 0.5965
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 0.9959, Val Loss: 0.9983, Test Loss: 0.9983, Val Acc: 0.5940, Test Acc: 0.5937

Epoch 18, Train Loss: 0.9925, Val Loss: 0.9929, Test Loss: 0.9949, Val Acc: 0.5949, Test Acc: 0.5951

Epoch 19, Train Loss: 0.9901, Val Loss: 0.9873, Test Loss: 0.9878, Val Acc: 0.5983, Test Acc: 0.5989
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 20, Train Loss: 0.9874, Val Loss: 0.9854, Test Loss: 0.9869, Val Acc: 0.6006, Test Acc: 0.5994
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 21, Train Loss: 0.9850, Val Loss: 0.9806, Test Loss: 0.9813, Val Acc: 0.6026, Test Acc: 0.6015
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 22, Train Loss: 0.9828, Val Loss: 0.9809, Test Loss: 0.9813, Val Acc: 0.6025, Test Acc: 0.6010

Epoch 23, Train Loss: 0.9803, Val Loss: 0.9820, Test Loss: 0.9829, Val Acc: 0.6026, Test Acc: 0.6029
ðŸŒ¸ New best epoch! ðŸŒ¸

