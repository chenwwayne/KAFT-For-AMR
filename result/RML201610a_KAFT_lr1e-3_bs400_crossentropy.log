Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 2.1318, Val Loss: 1.9487, Test Loss: 1.9525, Val Acc: 0.2585, Test Acc: 0.2580
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.9200, Val Loss: 1.8563, Test Loss: 1.8557, Val Acc: 0.2896, Test Acc: 0.2916
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.8169, Val Loss: 1.7617, Test Loss: 1.7630, Val Acc: 0.3233, Test Acc: 0.3216
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.7446, Val Loss: 1.7081, Test Loss: 1.7034, Val Acc: 0.3403, Test Acc: 0.3423
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.6971, Val Loss: 1.6723, Test Loss: 1.6711, Val Acc: 0.3505, Test Acc: 0.3476
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 5, Train Loss: 1.6448, Val Loss: 1.6178, Test Loss: 1.6157, Val Acc: 0.3793, Test Acc: 0.3820
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 6, Train Loss: 1.5394, Val Loss: 1.4376, Test Loss: 1.4351, Val Acc: 0.4587, Test Acc: 0.4596
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.4442, Val Loss: 1.4219, Test Loss: 1.4197, Val Acc: 0.4673, Test Acc: 0.4691
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.3967, Val Loss: 1.3877, Test Loss: 1.3864, Val Acc: 0.4801, Test Acc: 0.4822
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.3537, Val Loss: 1.3148, Test Loss: 1.3108, Val Acc: 0.5048, Test Acc: 0.5052
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 1.3211, Val Loss: 1.2908, Test Loss: 1.2885, Val Acc: 0.5102, Test Acc: 0.5105
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.2954, Val Loss: 1.2810, Test Loss: 1.2799, Val Acc: 0.5134, Test Acc: 0.5129
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 1.2717, Val Loss: 1.2717, Test Loss: 1.2707, Val Acc: 0.5180, Test Acc: 0.5207
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 1.2614, Val Loss: 1.2682, Test Loss: 1.2663, Val Acc: 0.5143, Test Acc: 0.5155

Epoch 14, Train Loss: 1.2431, Val Loss: 1.2354, Test Loss: 1.2342, Val Acc: 0.5307, Test Acc: 0.5309
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 1.2367, Val Loss: 1.2313, Test Loss: 1.2279, Val Acc: 0.5320, Test Acc: 0.5326
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.2250, Val Loss: 1.2203, Test Loss: 1.2214, Val Acc: 0.5335, Test Acc: 0.5324
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 1.2201, Val Loss: 1.2147, Test Loss: 1.2162, Val Acc: 0.5357, Test Acc: 0.5365
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 18, Train Loss: 1.2106, Val Loss: 1.2388, Test Loss: 1.2415, Val Acc: 0.5297, Test Acc: 0.5305

Epoch 19, Train Loss: 1.2089, Val Loss: 1.2271, Test Loss: 1.2272, Val Acc: 0.5318, Test Acc: 0.5317

Epoch 20, Train Loss: 1.2025, Val Loss: 1.2102, Test Loss: 1.2132, Val Acc: 0.5354, Test Acc: 0.5363

Epoch 21, Train Loss: 1.1992, Val Loss: 1.2100, Test Loss: 1.2092, Val Acc: 0.5398, Test Acc: 0.5392
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 22, Train Loss: 1.1944, Val Loss: 1.2112, Test Loss: 1.2125, Val Acc: 0.5366, Test Acc: 0.5362

Epoch 23, Train Loss: 1.1884, Val Loss: 1.1961, Test Loss: 1.2002, Val Acc: 0.5399, Test Acc: 0.5388
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 24, Train Loss: 1.1878, Val Loss: 1.2094, Test Loss: 1.2113, Val Acc: 0.5353, Test Acc: 0.5348

Epoch 25, Train Loss: 1.1857, Val Loss: 1.2070, Test Loss: 1.2049, Val Acc: 0.5388, Test Acc: 0.5396

Epoch 26, Train Loss: 1.1808, Val Loss: 1.1976, Test Loss: 1.1985, Val Acc: 0.5421, Test Acc: 0.5436
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 27, Train Loss: 1.1771, Val Loss: 1.1932, Test Loss: 1.1953, Val Acc: 0.5410, Test Acc: 0.5402

Epoch 28, Train Loss: 1.1739, Val Loss: 1.2007, Test Loss: 1.2051, Val Acc: 0.5432, Test Acc: 0.5423
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 29, Train Loss: 1.1738, Val Loss: 1.1966, Test Loss: 1.1969, Val Acc: 0.5455, Test Acc: 0.5434
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 30, Train Loss: 1.1716, Val Loss: 1.1926, Test Loss: 1.1927, Val Acc: 0.5444, Test Acc: 0.5469

Epoch 31, Train Loss: 1.1699, Val Loss: 1.1861, Test Loss: 1.1876, Val Acc: 0.5482, Test Acc: 0.5459
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 32, Train Loss: 1.1642, Val Loss: 1.2035, Test Loss: 1.2015, Val Acc: 0.5437, Test Acc: 0.5485

Epoch 33, Train Loss: 1.1619, Val Loss: 1.1907, Test Loss: 1.1962, Val Acc: 0.5457, Test Acc: 0.5450

Epoch 34, Train Loss: 1.1598, Val Loss: 1.1941, Test Loss: 1.1985, Val Acc: 0.5458, Test Acc: 0.5437

Epoch 35, Train Loss: 1.1571, Val Loss: 1.1874, Test Loss: 1.1916, Val Acc: 0.5478, Test Acc: 0.5477

Epoch 36, Train Loss: 1.1553, Val Loss: 1.1923, Test Loss: 1.1966, Val Acc: 0.5452, Test Acc: 0.5443

Epoch 37, Train Loss: 1.1539, Val Loss: 1.1846, Test Loss: 1.1861, Val Acc: 0.5486, Test Acc: 0.5488
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 38, Train Loss: 1.1520, Val Loss: 1.2014, Test Loss: 1.2032, Val Acc: 0.5458, Test Acc: 0.5461

Epoch 39, Train Loss: 1.1485, Val Loss: 1.1867, Test Loss: 1.1891, Val Acc: 0.5505, Test Acc: 0.5492
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 40, Train Loss: 1.1448, Val Loss: 1.2026, Test Loss: 1.2026, Val Acc: 0.5453, Test Acc: 0.5471

Epoch 41, Train Loss: 1.1427, Val Loss: 1.1874, Test Loss: 1.1888, Val Acc: 0.5476, Test Acc: 0.5491

Epoch 42, Train Loss: 1.1416, Val Loss: 1.1989, Test Loss: 1.2020, Val Acc: 0.5469, Test Acc: 0.5449

Epoch 43, Train Loss: 1.1408, Val Loss: 1.1963, Test Loss: 1.1983, Val Acc: 0.5447, Test Acc: 0.5466

Epoch 44, Train Loss: 1.1365, Val Loss: 1.1902, Test Loss: 1.1919, Val Acc: 0.5474, Test Acc: 0.5457

Epoch 45, Train Loss: 1.1363, Val Loss: 1.2039, Test Loss: 1.2069, Val Acc: 0.5464, Test Acc: 0.5460

Epoch 46, Train Loss: 1.1293, Val Loss: 1.1901, Test Loss: 1.1895, Val Acc: 0.5483, Test Acc: 0.5494

Epoch 47, Train Loss: 1.1288, Val Loss: 1.2039, Test Loss: 1.2023, Val Acc: 0.5449, Test Acc: 0.5455

Epoch 48, Train Loss: 1.1270, Val Loss: 1.2014, Test Loss: 1.2004, Val Acc: 0.5455, Test Acc: 0.5451

Epoch 49, Train Loss: 1.1226, Val Loss: 1.2011, Test Loss: 1.2030, Val Acc: 0.5485, Test Acc: 0.5485

Epoch 50, Train Loss: 1.1242, Val Loss: 1.2076, Test Loss: 1.2052, Val Acc: 0.5441, Test Acc: 0.5437

Epoch 51, Train Loss: 1.1210, Val Loss: 1.1984, Test Loss: 1.1980, Val Acc: 0.5470, Test Acc: 0.5473

Epoch 52, Train Loss: 1.1181, Val Loss: 1.2006, Test Loss: 1.2005, Val Acc: 0.5487, Test Acc: 0.5492

Epoch 53, Train Loss: 1.1112, Val Loss: 1.2065, Test Loss: 1.2062, Val Acc: 0.5463, Test Acc: 0.5465

Epoch 54, Train Loss: 1.1134, Val Loss: 1.2051, Test Loss: 1.2042, Val Acc: 0.5461, Test Acc: 0.5480

Epoch 55, Train Loss: 1.1092, Val Loss: 1.2022, Test Loss: 1.2041, Val Acc: 0.5482, Test Acc: 0.5483
Time to best model: 4845.56 seconds
Test score after training: 0.5483
Throughput after training: 9480.25 samples/second
Latency after training: 0.11 ms/sample

Result:
{'val': 0.5504772727272728, 'test': 0.5492045454545454, 'epoch': 39}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0936
SNR = -18: Acc =  0.0991
SNR = -16: Acc =  0.0973
SNR = -14: Acc =  0.1118
SNR = -12: Acc =  0.1509
SNR = -10: Acc =  0.2182
SNR =  -8: Acc =  0.3218
SNR =  -6: Acc =  0.4359
SNR =  -4: Acc =  0.5255
SNR =  -2: Acc =  0.6764
SNR =   0: Acc =  0.7818
SNR =   2: Acc =  0.8045
SNR =   4: Acc =  0.8236
SNR =   6: Acc =  0.8277
SNR =   8: Acc =  0.8268
SNR =  10: Acc =  0.8368
SNR =  12: Acc =  0.8436
SNR =  14: Acc =  0.8409
SNR =  16: Acc =  0.8214
SNR =  18: Acc =  0.8282
==========================

