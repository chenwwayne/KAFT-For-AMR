Using device: cuda
Using GPU(s): 0
Using device: cuda
Modulations: ['8PSK', 'AM-DSB', 'AM-SSB', 'BPSK', 'CPFSK', 'GFSK', 'PAM4', 'QAM16', 'QAM64', 'QPSK', 'WBFM']
SNRs: [-20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
Total samples: 220000
Padding: (132000, 128, 2)
Padding: (44000, 128, 2)
Padding: (44000, 128, 2)

Final data shapes:
X_train: (132000, 128, 2), Y_train: (132000, 11)
X_val: (44000, 128, 2), Y_val: (44000, 11)
X_test: (44000, 128, 2), Y_test: (44000, 11)
After reshaping and sampling:
X_train: (132000, 256) (sampled from original)
X_val:   (44000, 256) (sampled from original)
X_test:  (44000, 256) (sampled from original)
Y_train: (132000, 11)
{'d_out': 11, 'n_blocks': 3, 'd_block': 192, 'attention_n_heads': 8, 'attention_dropout': 0.2, 'ffn_d_hidden': None, 'ffn_d_hidden_multiplier': 1.3333333333333333, 'ffn_dropout': 0.1, 'residual_dropout': 0.0}
Model device: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
Total Parameters: 893.579K
FLOPs per sample: 209.493M
Device: CUDA
----------------------------------------------------------------------------------------

Epoch 0, Train Loss: 1.9491, Val Loss: 1.6279, Test Loss: 1.6261, Val Acc: 0.3995, Test Acc: 0.4013
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 1, Train Loss: 1.5949, Val Loss: 1.5458, Test Loss: 1.5440, Val Acc: 0.4259, Test Acc: 0.4263
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 2, Train Loss: 1.5415, Val Loss: 1.5121, Test Loss: 1.5119, Val Acc: 0.4407, Test Acc: 0.4420
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 3, Train Loss: 1.5117, Val Loss: 1.4794, Test Loss: 1.4785, Val Acc: 0.4514, Test Acc: 0.4523
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 4, Train Loss: 1.4770, Val Loss: 1.4791, Test Loss: 1.4798, Val Acc: 0.4508, Test Acc: 0.4522

Epoch 5, Train Loss: 1.4562, Val Loss: 1.4880, Test Loss: 1.4871, Val Acc: 0.4485, Test Acc: 0.4482

Epoch 6, Train Loss: 1.4277, Val Loss: 1.4226, Test Loss: 1.4226, Val Acc: 0.4739, Test Acc: 0.4729
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 7, Train Loss: 1.4059, Val Loss: 1.4136, Test Loss: 1.4107, Val Acc: 0.4766, Test Acc: 0.4760
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 8, Train Loss: 1.3945, Val Loss: 1.4060, Test Loss: 1.4095, Val Acc: 0.4771, Test Acc: 0.4758
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 9, Train Loss: 1.3711, Val Loss: 1.3914, Test Loss: 1.3897, Val Acc: 0.4851, Test Acc: 0.4835
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 10, Train Loss: 1.3579, Val Loss: 1.3757, Test Loss: 1.3745, Val Acc: 0.4918, Test Acc: 0.4937
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 11, Train Loss: 1.3446, Val Loss: 1.3801, Test Loss: 1.3779, Val Acc: 0.4922, Test Acc: 0.4929
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 12, Train Loss: 1.3238, Val Loss: 1.3511, Test Loss: 1.3512, Val Acc: 0.4973, Test Acc: 0.4988
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 13, Train Loss: 1.2999, Val Loss: 1.3340, Test Loss: 1.3308, Val Acc: 0.5097, Test Acc: 0.5109
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 14, Train Loss: 1.2767, Val Loss: 1.3133, Test Loss: 1.3132, Val Acc: 0.5162, Test Acc: 0.5180
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 15, Train Loss: 1.2629, Val Loss: 1.3002, Test Loss: 1.3017, Val Acc: 0.5206, Test Acc: 0.5235
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 16, Train Loss: 1.2495, Val Loss: 1.2984, Test Loss: 1.2954, Val Acc: 0.5238, Test Acc: 0.5262
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 17, Train Loss: 1.2375, Val Loss: 1.2918, Test Loss: 1.2892, Val Acc: 0.5242, Test Acc: 0.5260
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 18, Train Loss: 1.2271, Val Loss: 1.2913, Test Loss: 1.2852, Val Acc: 0.5278, Test Acc: 0.5299
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 19, Train Loss: 1.2182, Val Loss: 1.2944, Test Loss: 1.2920, Val Acc: 0.5285, Test Acc: 0.5300
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 20, Train Loss: 1.2034, Val Loss: 1.2752, Test Loss: 1.2746, Val Acc: 0.5337, Test Acc: 0.5347
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 21, Train Loss: 1.1939, Val Loss: 1.2744, Test Loss: 1.2682, Val Acc: 0.5360, Test Acc: 0.5376
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 22, Train Loss: 1.1835, Val Loss: 1.2873, Test Loss: 1.2801, Val Acc: 0.5337, Test Acc: 0.5345

Epoch 23, Train Loss: 1.1747, Val Loss: 1.2789, Test Loss: 1.2753, Val Acc: 0.5355, Test Acc: 0.5373

Epoch 24, Train Loss: 1.1676, Val Loss: 1.2615, Test Loss: 1.2554, Val Acc: 0.5422, Test Acc: 0.5460
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 25, Train Loss: 1.1566, Val Loss: 1.2730, Test Loss: 1.2703, Val Acc: 0.5430, Test Acc: 0.5441
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 26, Train Loss: 1.1496, Val Loss: 1.2745, Test Loss: 1.2713, Val Acc: 0.5387, Test Acc: 0.5398

Epoch 27, Train Loss: 1.1426, Val Loss: 1.2664, Test Loss: 1.2664, Val Acc: 0.5402, Test Acc: 0.5401

Epoch 28, Train Loss: 1.1348, Val Loss: 1.2666, Test Loss: 1.2683, Val Acc: 0.5412, Test Acc: 0.5408

Epoch 29, Train Loss: 1.1267, Val Loss: 1.2744, Test Loss: 1.2702, Val Acc: 0.5433, Test Acc: 0.5457
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 30, Train Loss: 1.1231, Val Loss: 1.2790, Test Loss: 1.2819, Val Acc: 0.5418, Test Acc: 0.5416

Epoch 31, Train Loss: 1.1117, Val Loss: 1.2829, Test Loss: 1.2813, Val Acc: 0.5450, Test Acc: 0.5466
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 32, Train Loss: 1.1044, Val Loss: 1.2965, Test Loss: 1.2930, Val Acc: 0.5432, Test Acc: 0.5437

Epoch 33, Train Loss: 1.0991, Val Loss: 1.2957, Test Loss: 1.2947, Val Acc: 0.5385, Test Acc: 0.5407

Epoch 34, Train Loss: 1.0888, Val Loss: 1.2980, Test Loss: 1.3035, Val Acc: 0.5392, Test Acc: 0.5387

Epoch 35, Train Loss: 1.0841, Val Loss: 1.3031, Test Loss: 1.3075, Val Acc: 0.5420, Test Acc: 0.5413

Epoch 36, Train Loss: 1.0752, Val Loss: 1.3140, Test Loss: 1.3151, Val Acc: 0.5399, Test Acc: 0.5400

Epoch 37, Train Loss: 1.0708, Val Loss: 1.3075, Test Loss: 1.3063, Val Acc: 0.5387, Test Acc: 0.5413

Epoch 38, Train Loss: 1.0108, Val Loss: 1.3368, Test Loss: 1.3390, Val Acc: 0.5475, Test Acc: 0.5475
ðŸŒ¸ New best epoch! ðŸŒ¸

Epoch 39, Train Loss: 0.9885, Val Loss: 1.3956, Test Loss: 1.3961, Val Acc: 0.5421, Test Acc: 0.5409

Epoch 40, Train Loss: 0.9769, Val Loss: 1.4016, Test Loss: 1.4032, Val Acc: 0.5412, Test Acc: 0.5410

Epoch 41, Train Loss: 0.9647, Val Loss: 1.4151, Test Loss: 1.4130, Val Acc: 0.5439, Test Acc: 0.5425

Epoch 42, Train Loss: 0.9533, Val Loss: 1.4366, Test Loss: 1.4344, Val Acc: 0.5427, Test Acc: 0.5429

Epoch 43, Train Loss: 0.9413, Val Loss: 1.4185, Test Loss: 1.4210, Val Acc: 0.5411, Test Acc: 0.5395

Epoch 44, Train Loss: 0.9332, Val Loss: 1.4541, Test Loss: 1.4544, Val Acc: 0.5407, Test Acc: 0.5400

Epoch 45, Train Loss: 0.8834, Val Loss: 1.5245, Test Loss: 1.5256, Val Acc: 0.5395, Test Acc: 0.5388

Epoch 46, Train Loss: 0.8682, Val Loss: 1.5384, Test Loss: 1.5379, Val Acc: 0.5367, Test Acc: 0.5374

Epoch 47, Train Loss: 0.8557, Val Loss: 1.5467, Test Loss: 1.5429, Val Acc: 0.5403, Test Acc: 0.5411

Epoch 48, Train Loss: 0.8467, Val Loss: 1.5931, Test Loss: 1.5984, Val Acc: 0.5361, Test Acc: 0.5369

Epoch 49, Train Loss: 0.8384, Val Loss: 1.5581, Test Loss: 1.5554, Val Acc: 0.5382, Test Acc: 0.5372

Epoch 50, Train Loss: 0.8295, Val Loss: 1.5942, Test Loss: 1.5966, Val Acc: 0.5384, Test Acc: 0.5372

Epoch 51, Train Loss: 0.7992, Val Loss: 1.6648, Test Loss: 1.6701, Val Acc: 0.5369, Test Acc: 0.5355

Epoch 52, Train Loss: 0.7908, Val Loss: 1.6539, Test Loss: 1.6561, Val Acc: 0.5375, Test Acc: 0.5355

Epoch 53, Train Loss: 0.7838, Val Loss: 1.6961, Test Loss: 1.7006, Val Acc: 0.5353, Test Acc: 0.5338

Epoch 54, Train Loss: 0.7783, Val Loss: 1.7096, Test Loss: 1.7122, Val Acc: 0.5363, Test Acc: 0.5363
Time to best model: 2356.25 seconds
Test score after training: 0.5363
Throughput after training: 6100.42 samples/second
Latency after training: 0.16 ms/sample

Result:
{'val': 0.5474545454545454, 'test': 0.5475227272727273, 'epoch': 38}

===== Accuracy By SNR =====
SNR = -20: Acc =  0.0923
SNR = -18: Acc =  0.0986
SNR = -16: Acc =  0.0923
SNR = -14: Acc =  0.1045
SNR = -12: Acc =  0.1314
SNR = -10: Acc =  0.1605
SNR =  -8: Acc =  0.2241
SNR =  -6: Acc =  0.3309
SNR =  -4: Acc =  0.4800
SNR =  -2: Acc =  0.5968
SNR =   0: Acc =  0.7205
SNR =   2: Acc =  0.8118
SNR =   4: Acc =  0.8450
SNR =   6: Acc =  0.8605
SNR =   8: Acc =  0.8627
SNR =  10: Acc =  0.8655
SNR =  12: Acc =  0.8636
SNR =  14: Acc =  0.8627
SNR =  16: Acc =  0.8632
SNR =  18: Acc =  0.8582
==========================

